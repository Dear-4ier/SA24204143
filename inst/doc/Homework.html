<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Cui Yangbo" />

<meta name="date" content="2024-12-07" />

<title>Homework Answers</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Answers</h1>
<h4 class="author">Cui Yangbo</h4>
<h4 class="date">2024-12-07</h4>



<div id="questions" class="section level1">
<h1>Questions</h1>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
<div id="answers" class="section level2">
<h2>Answers</h2>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>We will</p>
<ul>
<li><p>generate normal distributed samples.</p></li>
<li><p>generate a histogram.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>We will estimate <span class="math inline">\(\pi\)</span> by using
Monte Carlo method:</p>
<ul>
<li><p>Let <span class="math inline">\(n\)</span> be the number of
random points to generate</p></li>
<li><p>Let <span class="math inline">\(I\)</span> be the numbers of
points inside the unit circle.</p></li>
<li><p>Then the estimated <span class="math inline">\(\pi\)</span> will
be <span class="math display">\[\pi=\dfrac{4I}{n}\]</span></p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>estimate_pi <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    <span class="co"># Generate random x and y coordinates between -1 and 1</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="co"># Check if the point is inside the unit circle</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>      I <span class="ot">&lt;-</span> I <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    }</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  }</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="co"># Estimate pi</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">4</span> <span class="sc">*</span> I <span class="sc">/</span> n)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Generate different numbers of points</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>pi_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(points, estimate_pi)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Number_of_Points =</span> points, <span class="at">Estimated_Pi =</span> pi_estimates)</span></code></pre></div>
<pre><code>##   Number_of_Points Estimated_Pi
## 1            1e+01      3.60000
## 2            1e+02      3.08000
## 3            1e+03      3.20800
## 4            1e+04      3.17880
## 5            1e+05      3.13988</code></pre>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>Here we will</p>
<ul>
<li><p>calculate the correlation-coefficient matrix between variables in
the state.x77 dataset.</p></li>
<li><p>draw the visualization graph of the correlation coefficient
matrix.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(<span class="at">R =</span> <span class="fu">cor</span>(state.x77))</span></code></pre></div>
<pre><code>##             Population     Income  Illiteracy    Life Exp     Murder
## Population  1.00000000  0.2082276  0.10762237 -0.06805195  0.3436428
## Income      0.20822756  1.0000000 -0.43707519  0.34025534 -0.2300776
## Illiteracy  0.10762237 -0.4370752  1.00000000 -0.58847793  0.7029752
## Life Exp   -0.06805195  0.3402553 -0.58847793  1.00000000 -0.7808458
## Murder      0.34364275 -0.2300776  0.70297520 -0.78084575  1.0000000
## HS Grad    -0.09848975  0.6199323 -0.65718861  0.58221620 -0.4879710
## Frost      -0.33215245  0.2262822 -0.67194697  0.26206801 -0.5388834
## Area        0.02254384  0.3633154  0.07726113 -0.10733194  0.2283902
##                HS Grad      Frost        Area
## Population -0.09848975 -0.3321525  0.02254384
## Income      0.61993232  0.2262822  0.36331544
## Illiteracy -0.65718861 -0.6719470  0.07726113
## Life Exp    0.58221620  0.2620680 -0.10733194
## Murder     -0.48797102 -0.5388834  0.22839021
## HS Grad     1.00000000  0.3667797  0.33354187
## Frost       0.36677970  1.0000000  0.05922910
## Area        0.33354187  0.0592291  1.00000000</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">corrplot</span>(R,<span class="at">diag=</span>F)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="question-3.4" class="section level1">
<h1>Question 3.4</h1>
<p>The Rayleigh density [156, Ch. 18] is</p>
<p><span class="math display">\[f(x)=\frac
x{\sigma^2}\:e^{-x^2/(2\sigma^2)},\quad
x\geq0,\:\sigma&gt;0.\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution. Generate Rayleigh
<span class="math inline">\((\sigma)\)</span> samples for several
choices of <span class="math inline">\(\sigma&gt;0\)</span> and check
that the mode of the generated samples is close to the theoretical mode
<span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<div id="answer-to-3.4" class="section level2">
<h2>Answer to 3.4</h2>
<ul>
<li>首先根据pdf计算cdf</li>
</ul>
<p><span class="math display">\[F(x)=1-e^{-x^{2}/(2\sigma^{2})},x\geq0\]</span></p>
<ul>
<li>然后，令<span class="math inline">\(U\)</span>为<span class="math inline">\([0,1]\)</span>上均匀分布的r.v.，设</li>
</ul>
<p><span class="math display">\[U=F(X)\]</span></p>
<p>解出</p>
<p><span class="math display">\[X=\sigma\sqrt{-2\ln(u)}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># generate random samples from a Rayleigh $(\sigma)$ distribution</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma) {</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Generate Rayleigh $(\sigma)$ samples for several choices of $\sigma&gt;0$</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(sigma)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  </span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  <span class="co"># check the histogram</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="fu">hist</span>(</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    samples,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram for Rayleigh(&quot;</span>, sigma, <span class="st">&quot;) Distribution&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>  )</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  </span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>  <span class="co"># Theoretical mode is sigma</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Theoretical mode for sigma =&quot;</span>, sigma, <span class="st">&quot;is&quot;</span>, sigma, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  </span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>  <span class="co"># Estimated mode from histogram</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>  estimated_mode <span class="ot">&lt;-</span> <span class="fu">density</span>(samples)<span class="sc">$</span>x[<span class="fu">which.max</span>(<span class="fu">density</span>(samples)<span class="sc">$</span>y)]</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;mode of the generated samples for sigma =&quot;</span>,</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>      sigma,</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>      <span class="st">&quot;is&quot;</span>,</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>      estimated_mode,</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>      <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## Theoretical mode for sigma = 2 is 2 
## mode of the generated samples for sigma = 2 is 2.118617</code></pre>
<p><img role="img" src="data:image/png;base64,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R1NDA9JXxn993Ikzsic5AWWyV3iWlvOPBl7nKirD83dODCh3B0fv0ld6YVBng5RtYORvm1d2PG64dNou5rlw6iA3IGVIB7bWMeNirT59WXpM/tdJg3TmcSwrE1O6GHSVXKEa9WWXSkA+N5w64TDfv5i3uwXpvFFXg9RXYtyaPrr0uGXaTjhRBAHDPZOW0cn9Ova+MWjkMeFvNTLf4FJ2JF+n8Nxq5N77gnTMHYO2JQEBN9rizSoQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQERENDEAFW/5GpnlQX7WZR9NDFAVdahnX1IQJZMTrSd60FAtnT6qf493FRnnQlAipH6k41OejlMkwNUZo7J9B2ZpyazOG1A8vPIFKjDNDlAZYK4fAPh60fNywKkW1aQH9MbqMkBUgmgVVprLvuYBUgn97myXo+l6QFSHanMtkyu/tNsQbk3H/ZYmh4g0b1+Vd1MtZNWFxuX9htCEwSUL76rs9Fz08XWCtbpR/wJAtptvlCTIN14xJguqOw2N9vdJtGjWJGesB1NEFCVCa8SigUM2WzkIql/NfOgEw5ikwQ0KREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQERENBvagQLMKXBxQQAAAAASUVORK5CYII=" /><!-- --></p>
<pre><code>## Theoretical mode for sigma = 3 is 3 
## mode of the generated samples for sigma = 3 is 3.06303</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## Theoretical mode for sigma = 4 is 4 
## mode of the generated samples for sigma = 4 is 4.041771</code></pre>
</div>
</div>
<div id="question-3.11" class="section level1">
<h1>Question 3.11</h1>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing
probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1 − p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1 =
0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of <span class="math inline">\(p_1\)</span> that
produce bimodal mixtures.</p>
<div id="answer-to-3.11" class="section level2">
<h2>Answer to 3.11</h2>
<ul>
<li>首先定义一个函数能够Generate a random sample of size 1000 from a
normal location mixture.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>normal_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(p_1) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  p_2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_1</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  sample_with_mean_0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n <span class="sc">*</span> p_1, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  sample_with_mean_3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n <span class="sc">*</span> p_2, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  mixture_sample <span class="ot">=</span> <span class="fu">c</span>(sample_with_mean_0, sample_with_mean_3)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="co"># Graph the histogram of the sample with density superimposed</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> mixture_sample), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">label =</span> <span class="st">&quot;Density&quot;</span>)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>      <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Histogram of Mixture Distribution with p1 = &quot;</span>, p_1)) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>对<span class="math inline">\(p_1 = 0.75, 0.5, 0.25, 0.1\)</span>
绘制样本的直方图并叠加密度曲线</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="cf">for</span> (p_1 <span class="cf">in</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>)) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">normal_mixture</span>(p_1)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>observe whether the empirical distribution of the mixture appears to
be bimodal
<ul>
<li>当<span class="math inline">\(p_1 = 0.75\)</span>时：
<ul>
<li>大部分样本来自均值为0的正态分布，此时经验分布更倾向于单峰，且峰的位置接近均值0。虽然有一小部分样本来自均值为3的正态分布，但不足以形成明显的双峰。</li>
</ul></li>
<li>当<span class="math inline">\(p_1 = 0.5\)</span>时：
<ul>
<li>样本均匀地来自两个正态分布，此时经验分布更有可能呈现双峰。因为两个正态分布对混合分布的贡献相当，所以在均值0和3附近都有较高的概率密度，从而形成双峰。</li>
</ul></li>
<li>当<span class="math inline">\(p_1 = 0.25\)</span>时：
<ul>
<li>大部分样本来自均值为3的正态分布，此时经验分布更倾向于单峰，且峰的位置接近均值3。虽然有一小部分样本来自均值为0的正态分布，但不足以形成明显的双峰。</li>
</ul></li>
<li>当<span class="math inline">\(p_1 = 0.1\)</span>时：
<ul>
<li>绝大多数样本来自均值为3的正态分布，经验分布是单峰的，且峰接近均值3。</li>
</ul></li>
</ul></li>
<li>Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures
<ul>
<li>基于上述观察，可以推测当 <span class="math inline">\(p_1\)</span>
接近0.5时，混合分布的经验分布更有可能是双峰的。</li>
<li>当 <span class="math inline">\(p_1\)</span>
接近0或1时，混合分布的经验分布更倾向于单峰。</li>
</ul></li>
</ul>
</div>
</div>
<div id="question-3.20" class="section level1">
<h1>Question 3.20</h1>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t\geq 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X( t) = \sum _{i=
1}^{N(t)}Y_i\)</span>, <span class="math inline">\(t\geq 0\)</span>,
where <span class="math inline">\(\{N(t), t\geq 0\}\)</span> is a
Poisson process and <span class="math inline">\(Y_1,Y_2,\ldots\)</span>
are iid and independent of <span class="math inline">\(\{N(t),t\geq0\}.\)</span> Write a program to
simulate a compound Poisson<span class="math inline">\((\lambda)\)</span>–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda
tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda
tE[Y_1^2].\)</span></p>
<div id="answer-to-3.20" class="section level2">
<h2>Answer to 3.20</h2>
<ul>
<li>首先定义一个函数能够 simulate a compound Poisson<span class="math inline">\((\lambda)\)</span>–Gamma process</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, shape, scale, t) {</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="cf">if</span> (N <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> shape, <span class="at">scale =</span> scale)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(Y))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  }</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the
parameters</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>num_sims <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">rep</span>(lambda, <span class="at">each =</span> <span class="fu">length</span>(shape) <span class="sc">*</span> <span class="fu">length</span>(scale)),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(shape, <span class="at">each =</span> <span class="fu">length</span>(scale)), <span class="fu">length</span>(lambda)),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="at">scale =</span> <span class="fu">rep</span>(scale, <span class="fu">length</span>(lambda) <span class="sc">*</span> <span class="fu">length</span>(shape)),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="at">simulated_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="at">theoretical_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="at">mean_error =</span> <span class="cn">NA</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="at">simulated_var =</span> <span class="cn">NA</span>,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  <span class="at">theoretical_var =</span> <span class="cn">NA</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="at">var_error =</span> <span class="cn">NA</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results)) {</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>    num_sims,</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>    <span class="fu">compound_poisson_gamma</span>(results<span class="sc">$</span>lambda[i], results<span class="sc">$</span>shape[i], results<span class="sc">$</span>scale[i], t)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  )</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  results<span class="sc">$</span>simulated_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sims)</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  results<span class="sc">$</span>simulated_var[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(sims)</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  results<span class="sc">$</span>theoretical_mean[i] <span class="ot">&lt;-</span> results<span class="sc">$</span>lambda[i] <span class="sc">*</span> t <span class="sc">*</span> (results<span class="sc">$</span>shape[i] <span class="sc">*</span> results<span class="sc">$</span>scale[i])</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  results<span class="sc">$</span>theoretical_var[i] <span class="ot">&lt;-</span> results<span class="sc">$</span>lambda[i] <span class="sc">*</span> t <span class="sc">*</span> (results<span class="sc">$</span>shape[i] <span class="sc">*</span> (results<span class="sc">$</span>shape[i] <span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>                                                                               <span class="dv">1</span>) <span class="sc">*</span> results<span class="sc">$</span>scale[i] <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  results<span class="sc">$</span>mean_error <span class="ot">&lt;-</span> <span class="fu">abs</span>(results<span class="sc">$</span>simulated_mean[i] <span class="sc">-</span> results<span class="sc">$</span>theoretical_mean[i]) <span class="sc">/</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>    results<span class="sc">$</span>theoretical_mean[i]</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  results<span class="sc">$</span>var_error <span class="ot">&lt;-</span> <span class="fu">abs</span>(results<span class="sc">$</span>simulated_var[i] <span class="sc">-</span> results<span class="sc">$</span>theoretical_var[i]) <span class="sc">/</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>    results<span class="sc">$</span>theoretical_var[i]</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>打印结果，比较</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">print</span>(results, <span class="at">width =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>##    lambda shape scale simulated_mean theoretical_mean mean_error simulated_var theoretical_var  var_error
## 1       1     2     1       19.82064               20 0.01192953      57.12574              60 0.03157004
## 2       1     2     2       40.19185               40 0.01192953     247.10387             240 0.03157004
## 3       1     2     3       59.79225               60 0.01192953     538.17146             540 0.03157004
## 4       1     3     1       29.64736               30 0.01192953     113.62446             120 0.03157004
## 5       1     3     2       60.26964               60 0.01192953     469.40774             480 0.03157004
## 6       1     3     3       90.15474               90 0.01192953    1070.78623            1080 0.03157004
## 7       1     4     1       39.51477               40 0.01192953     191.94215             200 0.03157004
## 8       1     4     2       80.42041               80 0.01192953     859.69523             800 0.03157004
## 9       1     4     3      119.89646              120 0.01192953    1878.63391            1800 0.03157004
## 10      2     2     1       40.50329               40 0.01192953     130.62600             120 0.03157004
## 11      2     2     2       79.89261               80 0.01192953     488.47292             480 0.03157004
## 12      2     2     3      119.64917              120 0.01192953    1033.00084            1080 0.03157004
## 13      2     3     1       59.44828               60 0.01192953     255.51845             240 0.03157004
## 14      2     3     2      119.41519              120 0.01192953     998.29104             960 0.03157004
## 15      2     3     3      181.68217              180 0.01192953    2214.13450            2160 0.03157004
## 16      2     4     1       79.20964               80 0.01192953     416.24964             400 0.03157004
## 17      2     4     2      160.57931              160 0.01192953    1597.16350            1600 0.03157004
## 18      2     4     3      235.82484              240 0.01192953    3709.75021            3600 0.03157004
## 19      3     2     1       60.17564               60 0.01192953     184.37009             180 0.03157004
## 20      3     2     2      119.23079              120 0.01192953     734.18402             720 0.03157004
## 21      3     2     3      178.60215              180 0.01192953    1559.33297            1620 0.03157004
## 22      3     3     1       89.16983               90 0.01192953     369.00748             360 0.03157004
## 23      3     3     2      181.66896              180 0.01192953    1520.52386            1440 0.03157004
## 24      3     3     3      268.91739              270 0.01192953    3324.37114            3240 0.03157004
## 25      3     4     1      120.76818              120 0.01192953     627.01148             600 0.03157004
## 26      3     4     2      239.63283              240 0.01192953    2457.25450            2400 0.03157004
## 27      3     4     3      355.70537              360 0.01192953    5229.52176            5400 0.03157004</code></pre>
<ul>
<li>绘制模拟均值与理论均值的对比图：</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> simulated_mean, <span class="at">color =</span> <span class="st">&quot;Simulation&quot;</span>)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> theoretical_mean, <span class="at">color =</span> <span class="st">&quot;Theory&quot;</span>)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(shape <span class="sc">~</span> scale) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Mean&quot;</span>, <span class="at">x =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAC7lBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAv8QZGT8ZGWIZP4EZYp8aGhozMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNs/GRk/GT8/GWI/Pxk/gb1NTU1NTVNNTVVNTVlNTVxNTV5NTWRNTW5NTXlNTY5NU01NXJ1NXp1NZKJNaX9NaatNbqtNb2RNcshNeXlNg45Ng6JNg8hNjqJNjshRTWlTTU1TTWBUTY5WTU1ZTU1ZTVtZTV5ZTWlZTW5ZZKtZjuReTU1eTW5eaateg4NgTU1iGRliGT9iGWJin9ljTU1jTY5kTU1kTVJkTVNkTW5kTYNkTY5kXFlkaU1kb01mAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmZmZmkJBmkNtmtrZmtttmtv9pTU1pTVlpq+RuTU1uTVxuTW5uTW9uTXluTYNuTY5ubqtuq7Vuq+RvTU1vTV5vtf95TU15TW55VU15bm55yMh5yP97b1N/Uk1/U01/uat/zf+BPxmBPz+Bn4GBvb2BvdmDTVODjmSDjm6DyP+OTU2OTVmOTVyOTV6OTWOOTWSOTW6OTW+OTY6OY02Obk2Obm6Og02Ooo6OtY6OtauOyMiOyP+QOgCQOjqQOmaQZgCQZjqQZmaQkDqQkGaQkLaQtpCQttuQ27aQ2/+d5P+fYhmf2dmijk2rY1mraU2rbk2rboOrbo6ryKur5P+1q261//+2ZgC2Zjq2kDq2kGa2tpC2ttu225C229u22/+2/9u2//+9gT+92dnIg03Ijk3IyHnIyIPIyI7I5J3I5KvI/7XI/8jI/+TI///Nf1PZn2LZvYHZ2Z/Z2b3Z2dnbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb///knV7kq2Pkq2Tkq27k5Kvk/8jk///r6+v4dm3/tmb/yHn/yI7/zX//25D/27b/29v/5I7/5J3/5Kv//6L//7X//7b//8j//83//9v//+T///98uAcNAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQMklEQVR4nO2deZwcRRXHezfZaZBlwhkdPMaLiCfe8T4Qj0QORdSFCIoy6hoUjLfxQsVjvRBP2EUQBJYEDbI6IIa40XhgWENgBERcZTU7YxzUwV0m9Z/1qrunq6+p7pnq6mPf75NM9/Trme757qv3qo96rRFUV2lJ70DahYAEQkACISCBEJBACEggBCQQAhLIDaj9s4M1bdmZPX1Xe2JoNtonrte0AvtI9ZArzUV3vqnU08bjkgtQs6gxrezluyIDatAtFdhcVRuYtHag1Mu2Y5MT0MKItvLPhNy1Tquo2Hijs5nqwMElNlNbViyp2HRoOQHVzD9fswi+cN86TVu+Dd6V7igOvJU0itrhsxRiic4sZ3/wO2h7pAbqO4WaNngTeFD7UrqINVHr49SxbjyYrWbKMlSpAw1Os0XVwcuY97UnzmCAYJVDtjk34foWRXIAak+Y+0vupv8brLlR128WD6OzA1cUWYtYGIF3rEnUjPZYoR9cVtSG/kIBtSfMRfbHzUUdb+kYHIC2rgDkzYO2AqCmtQq/Cee3qJID0MJIwX5D9+hM2MGhWbq7Z5I7NOpd4Fm0GRZm2zdQVJQn8y+YA9eDGNQsrpy1Fpkfp3M0EtfMaMMZ+CY2+IuJEkwL1F3pKuCDdxZdm+C/RZmCAcFeEYgOk2xuYQTazwQAYo2hyv72d9/4/aKBatoCtOyMm5wfN4yd77YNDkDT1SFovhUA1DTiUM27CcceKlE3QGzvGwCoZNmqAIitVGNtj3l9wcxf7BXajXb4Nu7jlrHg/l4nILZgcBo21jBak+a3iUQB2THoj4dvEwOije2wH/z8nhEHIHLnOhZaIgOiwZ+2MOIE5N1EooA6WWxhBH6h3cRKDkDGnloMjABhA6L60yVahW9iLkD+TQwCNf1Co4lZy72bSBaQ3Q8qOYJ0yQFIe4gRpOl+z0JChjhsAWpQI2nfAFjsIO34aQFBepr61Jvpqxmkacf6PvY3cG8iWUCdnjTsBpfmSw5Ay4pGfrYyLw/IXAa/3k7zzp/WMbgAQXokxsbMNlby2UTCgMh9lxY7x2JNu6PojEHQY4ReHOvxXUl/HNfEWEdx5Sz3cc9PswwuQDS+V8yNsVXYXng2kTQgsdRn2kSFgARCQAIhIIHwjKJACEggBCQQAhIIAQmEgATqDdDt/pJjTpcQkEAISCAEJBACEggBCYSABEJAAiEggfoGdOvDNgcSuPWI4eHjggHtGh7ef7PXnC71C2gX/xtd5t1rz7v91oeeF2QGtNsPyDmgTft9JtiDdsGv33RckDnI/9KlWJuY6UVdzLn3IBGg2859hJeA/dkj9jvPa06X4gW0ew3HJ6yDpUsxZzEuh/mneZ8QlS7FCcjFxxPDH/TLJe5B24dBwVmM2pdADBK1oejmdAkBCYSABEJAAiEggRCQQL0Bmifz8+YLP+XMHtu80BzALWFwCEggBCQQAhIoRTcv5AkQepBACEggBCQQAgLtLZePmiFkcax89J7OxBAComqdPUPmVpN9W8a5iSkEZIpCWrxghpuYyxGQKeozrXP2kMXzp8wJXXYgVSy7kj1ArdFVU2Tv0YyMOTEt6EGmbNexPQiEgCztGMcYFCSzUe3bssHIYhswi7k0Vy7TGIT9oF6EgJJQngChBwmEgARCQAIhIFBrtFwexzQfaIEDi9b6KTzdEaS9gAMPNaIfrMZ7umP3GnZj8Pb90nJrXldAcACm6nRHvW4AWvtwdmMs3MCYekCLYxuI94QZSD6gugXo1Zs3HWBMUw+oNUpzGFEUgzhAt2+n3pMBDzL4EEWnO+q6DQhGCWUgBs2VQeNq+kG6bnpQxrJYkGQD0rOa5oMkGZA+nzdAcqUbkzwBkupB+nx2e9JB6gUQTeQeM12m61k+1AhSD4DqPoCAT51kGBDrGUpK8/6AaHbPMKC9cPuLrNMd0NNxm4FPhgHtWHUd9SA5hxo00vh4EPCZzy4go4nJON2h6/6LnW8zCqi/0x3gIrqVx11m3fUVGQXU1+kOlsYD+kG6+ysyCqivGORMUw6z7vmKjALq63SH7khTvFn3fkVGAYXvB3nTlE4cacoSNDyfI5EMAgqUHyBPT1B3R2FL0PCWIiBXT9AbZCzBmjkHxMnwG103wo29zL/rY5nrPovzBMj+s9dZJtedMcg6Rg9sYnVPfM+ZB3GAwHXcWSygDXGfzjsgIzlZDcsLqI6AwHNYM+LbC2f2I2BpKQDS4USXuKO4dAExH0FAgfLP07lUGi77pFoISCAEJBACEggBCZQbQM0Vk7F8LwISKAU3L8jpKCIgt+ABmgV7CoC4WXhpHnSZ9bDt3pVZQPC8zIWRCpvCfwqEmzUAFSU8Sy+zgKwm1QAfgWdEr5jkZk1AEp69nqIgHQ1Qw2w8DXj8KtCggOxZe9qvMutBCChsE2PPRDaamD2LgDrB2SdIw4PZ2xMDsQNKef2g4DTPHun9tlPiBoT1g5iwfpBADkDm0+bt3ifWD3IAcj/MHesHEScg6Lk7hfWDXB7k6ZqrG9SbieFQDf7YV239oHoWAC2MaHyQVlo/qF7XowGa95dcOiQ9PWlrSCYCCjBHHpKZCCBPP0id9Kj9oCQAtSdKNJF5k73P3sn2ID1ymk8CEKCplowzLN0lG1APg3qTAlQrOJN9wN7JBdTLoN5EYlCV0amp9iC9l550IoBoECJVbcA8i6KswFJ2ADmkrMBSb6OeBYCg00tDRfMgn3BhL6RzvmuEAqSqwJJr1LPx3MhdPo+3DQLEbql1AWKpOChWOAB1peMBVNO0Cv+1Cgos2XfkMxq3fdqoaiKs/sLz4QiZVvbLF06ZpNP2xZdrWqlB/7OlptNAl4/2aLTBrfQNTOmiQy+hy9zbcQbpoXtGKtxZIakFloLGzROHB7HqL9uPE9cP6g6oPWH8mQEQnNEvFjpk2ISyM+dgmdG3aRb9ujiuNA+u2UnzUgsshRw3Dx4EZbr69CBCqMsMMAjtiycJ/Df8iQs7C6eagOgMZw0PSG6BpbDj5m87d3j4gO3i+kHdYxATu38hCFAVgrjtRHQNMSAa1e4BRiWOj7QCS+7RUgxQH+Pmu2exBgsT1UoQIHCEDp3QHsT8EoIZk9wCS/xoKXux3vu4+e6AWBazgnQHEESemuU3poNxMSgEoLCKDEj3TfO6YzXp/SBPDIIs/WAWeWBu+TqakPgsliAgg4TbrJP4AEmTkttfQhVeyBWgaB4US+UF5YDgwr+mhTyjGBqQo4KS09xn5QX1HtTw6WcHKSwgZ0/QYe638kIiTazqYtR3gaUYS1MkFIOgoXUY9V9gydkT5M19l6ZILkjTvoERgyQUWHJWUOLM/ZemSM6DBuzbsqIVWPIOQwwoLgCH8D5KPyAnHRKxwJLi2h1JZLEB9y19kQosRajd4T+sPuWA/PpBUQosuY9GfaJwtgH5KUyBJZamoMiAo3aHb4EgYps98T27gAT9IKO4iSuLBQQZ7tM5ARQoDlBSxU26AjLjxdBd4qsWIvUJKLniJiIPYmd2QlzWEamv0x1QQNKvCENvhRliAXQ6OzIwzohZJ8YOWTd4eoU0DxVeYQf1UR7HW0Sps/P+LiIwRwWke+QFZF7JqZbgrozO5Z0KaZTgX6yAdN37K9UCCtnEzKtgC6fyJ+cXTpu9PtxAjsyWx4kECO5OHZjkLu+0L77qtFAtLLvlcSIBOtW6Umh5EKm9pRTup/ZVoisrgKz75uzLO+FHkaflLtd4AdE2Bgea9uUd0v5eyA5Aigb1RpMIkEDNlSFXXKKAap4zF0FaooDCCwEJhIAEQkACZRaQKmW2H6RKCEig1ADKwpDM8JIPKPKQTFVKDaCoQzJVKS1ZLGeA5HsQPkZUBAizmOQxq6qUkgJLWQSkssBSZp/Uq6jAUnaf1KuowJJxw1n2AKkqsNTToF5V6u5BagosZRiQkgJLWX3Ws6oCS9l91rOiAkvZBdRFEgG5Rj0jILc5n4B6kf+taNw993kC1IMH5fJ584GSBijbz5sPVi+A8ve8+S7qAZDscfOq1AWQ1AJLul8W62fcvCopKrAkv7CAKqkpsBSlsMDuNVxhkzQDAsVbYMk17tACtPaz53L1p1INSFaBJd23Jx1QWGD3WqggJCzRpUrdAMkqsBSl8sLuNcOG9hdUoFKlrllMToGliJUXwIMyEYOkFFhyFClzmPstLKBKwYBkFFiKsTSFKsXbkw4uTdF35QVVivd0R10PGlvnU1ogT4DCelCMpSlUKVZArq4yZ16SgLyH6wGArMy2xAB5z4jFWrtDlfotLNAFkKcnaElKaQpV6gYoWoElXW1xE1XqAihSgSVdd8Wg7sVNchKDwhdY8nRrAmordVNGAYlOd4A76LozzQuqv3gTYK48CGT/qk6hRCeg+Ku/qJIQkCAG1flKL5ZUFDdRpX4LLLHyL0saUNd+EG1dfEqyFJCmuE/nBFCgjF+lu1M5Z17igKAJ6d4DKksICFKX5B3JZD8oUMaJQvSgQKWgPI4qZbY8jiolfo8iAkJACMhHB3ZeuNkDfczudcKYUyUEJBACEggBCZSWwgKpFQISCAEJhIAEQkACRQbETsPCWfyxcrn8BbgJbeM/y+VVP4Ub0o7aOUbnmPk/LyyXv8huUvvoGFRwCGm2z+qmRVEBscvR9OWWLSdNzT3jxJdOkda7XrCR/OFJO8bhfsbvlB+9Gsy/H/0A+euR3z5pivz32OfPzD11dSgzf3U7LYoIiF2OhpedX1tNWu/58NNg2ckz5F/P+wgMb/3gquvWn3ANNf/6cTOkdfzrnwXLNpLWWa/7Vgiz48pSWtRrE7sZLiR+mTaU8kVfecUecu9jRunshefsab37Q1Om+f7XHEuXfffFV5PFzz1zLJSZuzaZFvUK6Lc0Wvzvfc+ZIg984pVH/330yPe/fIrs++FTLALUvG/Li+iyBz7+hD2t0Ud+cn0oc44AUR9YHHvJFFkceyP85e9/7aeo7VfH2C7yj7H3ng/mNxxDf/ZX10+FMucI0M4Lbh698OyZ1uj4josgdhy/kbBo1Fp/AkSSnV8/cbxlmE+G99eMhzLnKAbd8qPnjs89/clvH9/34988/p3kb4+i7WPftd/c0HrHajD/7tiXEcN87TeeuGfu2V8KZ85+FjPv+Djr5Jl7yx19vlx+7NWsTsMi6+hQ80+Y4WPs9VVgCWnOfj9oyQkBCYSABEJAAiEggRCQQLIABT0KxrG8IX7MduqEgARCQALJBNQsappWorNX0JkSvKvQN5dr2tAse/DQwOXw6CFjpcxIIqCFkQohtcHpZpECqQEV8017okD5lOj/wWlrJUmbjV8SAf171pjCMwSJ8WK9WTHJWhcFY60kabPxS2oMahhPyoNZ64U9zIu6TQ2aGXtjrCRps/FLahOjvxuYdANkrSRps/FLIiB4SB5puD3InLImRl+slSRtNn7JBAS+UXQD6gTpAgvS1kqSNhu/ZMagKg0uV41UXB5E03yB2GneXEnSZuMXHosJhIAEQkACISCBEJBACEggBCQQAhIIAQmEgAT6P1fEPyF6Rz2HAAAAAElFTkSuQmCC" /><!-- --></p>
<ul>
<li>模拟方差与理论方差的对比图</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> simulated_var, <span class="at">color =</span> <span class="st">&quot;Simulation&quot;</span>)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> theoretical_var, <span class="at">color =</span> <span class="st">&quot;Theory&quot;</span>)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(shape <span class="sc">~</span> scale) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Variance&quot;</span>, <span class="at">x =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Variance&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>根据比较，可以认为</p>
<p><span class="math display">\[E[X(t)]=\lambda tE[Y_1]\qquad
Var(X(t))=\lambda tE[Y_1^2].\]</span></p>
</div>
</div>
<div id="question-5.4" class="section level1">
<h1>Question 5.4</h1>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x =
0.1,0.2,...,0.9.\)</span> Compare the estimates with the values returned
by the <strong>pbeta</strong> function in R.</p>
<div id="answer-to-5.4" class="section level2">
<h2>Answer to 5.4</h2>
<ul>
<li>生成计算 Beta(3, 3)分布的 CDF 的Monte Carlo estimate的函数</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>monte_carlo_beta_cdf_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fl">1e4</span>, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(u <span class="sc">&lt;=</span> x))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1,0.2,...,0.9.\)</span></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>monte_carlo_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x_values)) <span class="co"># Monte Carlo估计值</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>pbeta_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x_values)) <span class="co"># pbeta 函数值</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x_values)) {</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  monte_carlo_estimates[i] <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">monte_carlo_beta_cdf_mean</span>(x_values[i]), <span class="dv">4</span>), <span class="at">nsmall =</span> <span class="dv">4</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  pbeta_values[i] <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">pbeta</span>(</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    x_values[i], <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  ), <span class="dv">4</span>), <span class="at">nsmall =</span> <span class="dv">4</span>)</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># 输出结果进行比较</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_values,</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>                 <span class="at">monte_carlo =</span> monte_carlo_estimates,</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>                 <span class="at">pbeta =</span> pbeta_values)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##     x monte_carlo  pbeta
## 1 0.1      0.0100 0.0086
## 2 0.2      0.0595 0.0579
## 3 0.3      0.1620 0.1631
## 4 0.4      0.3143 0.3174
## 5 0.5      0.4935 0.5000
## 6 0.6      0.6774 0.6826
## 7 0.7      0.8364 0.8369
## 8 0.8      0.9400 0.9421
## 9 0.9      0.9912 0.9914</code></pre>
<ul>
<li>绘图比较</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(monte_carlo), <span class="at">color =</span> <span class="st">&quot;蒙特卡洛估计&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(pbeta), <span class="at">color =</span> <span class="st">&quot;pbeta 值&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(monte_carlo), <span class="at">color =</span> <span class="st">&quot;蒙特卡洛估计&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(pbeta), <span class="at">color =</span> <span class="st">&quot;pbeta 值&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;x 值&quot;</span>, <span class="at">y =</span> <span class="st">&quot;CDF 值&quot;</span>, <span class="at">color =</span> <span class="st">&quot;曲线类型&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;蒙特卡洛估计&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;pbeta 值&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-5.9" class="section level1">
<h1>Question 5.9</h1>
<p>The Rayleigh density is</p>
<p><span class="math display">\[f(x)=\frac
x{\sigma^2}\:e^{-x^2/(2\sigma^2)},\quad
x\geq0,\:\sigma&gt;0.\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma)\)</span> distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}2\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}2\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
<div id="answer-to-5.9" class="section level2">
<h2>Answer to 5.9</h2>
<ul>
<li>对偶变量法采样</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span></code></pre></div>
<ul>
<li>想法是先生成 <span class="math inline">\(n\)</span> 个 <span class="math inline">\(X\)</span>，再生成对偶的 <span class="math inline">\(n\)</span> 个 <span class="math inline">\(X^\prime\)</span>, 最后得到<span class="math inline">\(n\)</span>个样本的</li>
</ul>
<p><span class="math display">\[\text{Sample_antithetic}=\frac{X+X&#39;}2\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Implement a function to generate samples from a Rayleigh($\sigma)$ distribution, using antithetic variables.</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>antithetic_rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u))</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  X_prime <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">return</span>((X <span class="sc">+</span> X_prime) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co"># 对偶变量法采样</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>Sample_antithetic <span class="ot">&lt;-</span> <span class="fu">antithetic_rayleigh</span>(sigma, n)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(Sample_antithetic)</span></code></pre></div>
<ul>
<li><p>独立采样</p>
<ul>
<li>想法是独立生成<span class="math inline">\(n\)</span>个<span class="math inline">\(X_1\)</span>和<span class="math inline">\(n\)</span>个<span class="math inline">\(X_2\)</span>，得到<span class="math inline">\(n\)</span>个样本的</li>
</ul></li>
</ul>
<p><span class="math display">\[\text{Sample_independent}=\frac{X_1+X_2}2\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># 生成瑞利分布样本的函数(上次作业)</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>}</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co"># 独立采样</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>X_1 <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(sigma, n)</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>X_2 <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(sigma, n)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>Sample_independent <span class="ot">&lt;-</span> (X_1 <span class="sc">+</span> X_2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(Sample_independent)</span></code></pre></div>
<ul>
<li>计算percent reduction in variance</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>reduced_percentage <span class="ot">&lt;-</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对于参数 sigma =&quot;</span>, sigma, <span class="st">&quot;和样本数量 n =&quot;</span>, n, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对于参数 sigma = 1 和样本数量 n = 10000</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立采样的样本方差为&quot;</span>, var_independent, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立采样的样本方差为 0.2090716</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶变量法采样的样本方差为&quot;</span>, var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶变量法采样的样本方差为 0.01129598</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减少的百分比为：&quot;</span>, reduced_percentage, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减少的百分比为： 94.59708 %</code></pre>
</div>
</div>
<div id="question-5.13" class="section level1">
<h1>Question 5.13</h1>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are `close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}\:e^{-x^2/2},\quad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}\:e^{-x^2/2}\:dx\]</span>
by importance sampling? Explain.</p>
<div id="answer-to-5.13" class="section level2">
<h2>Answer to 5.13</h2>
<p>以下是用 R Markdown 解决这个问题的步骤：</p>
<ul>
<li>首先定义目标函数 <span class="math inline">\(g(x)\)</span>：</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>定义<span class="math inline">\(f_1\)</span> 和 <span class="math inline">\(f_2\)</span>： <span class="math display">\[f_1=e^{-(x-1)},\quad x&gt;1.\]</span> <span class="math display">\[f_2=2e^{-2(x-1)},\quad x&gt;1.\]</span> 由于
<span class="math display">\[\int_{1}^{\infty}e^{-(x-1)}dx=1\]</span>
<span class="math display">\[\int_{1}^{\infty}2e^{-2(x-1)}dx=1\]</span>
它们是<span class="math inline">\((1,\infty)\)</span>上的pdf</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>}</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>绘制函数图像
<ul>
<li>使用 <code>ggplot2</code> 包绘制 <span class="math inline">\(g(x)\)</span>、<span class="math inline">\(f_1(x)\)</span> 和 <span class="math inline">\(f_2(x)\)</span> 在 <span class="math inline">\((1,\infty)\)</span> 上的图像：</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># 生成数据</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  <span class="at">g =</span> <span class="fu">g</span>(x),</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="fu">f1</span>(x),</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="fu">f2</span>(x)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>)</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co"># 绘制图像</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> g, <span class="at">color =</span> <span class="st">&quot;g(x)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> f1, <span class="at">color =</span> <span class="st">&quot;f1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> f2, <span class="at">color =</span> <span class="st">&quot;f2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;函数值&quot;</span>, <span class="at">color =</span> <span class="st">&quot;函数&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>    <span class="st">&quot;g(x)&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>    <span class="st">&quot;f1&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>    <span class="st">&quot;f2&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  ))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>分析方差</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co"># Importance sampling for f1</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>gf1 <span class="ot">&lt;-</span> <span class="fu">g</span>(samples1) <span class="sc">/</span> <span class="fu">f1</span>(samples1)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(gf1)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co"># Importance sampling for f2</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>gf2 <span class="ot">&lt;-</span> <span class="fu">g</span>(samples2) <span class="sc">/</span> <span class="fu">f1</span>(samples2)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>(gf2)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1在估计积分时产生的方差为：&quot;</span>, var1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f1在估计积分时产生的方差为： 0.02515334</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2在估计积分时产生的方差为：&quot;</span>, var2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f2在估计积分时产生的方差为： 0.01319606</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Determine which variance is smaller</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="cf">if</span> (var1 <span class="sc">&lt;</span> var2) {</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;f1在估计积分时产生的方差更小&quot;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;f2在估计积分时产生的方差更小&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## f2在估计积分时产生的方差更小</code></pre>
</div>
</div>
<div id="question-monte-carlo-experiment" class="section level1">
<h1>Question Monte Carlo experiment</h1>
<ul>
<li>For <span class="math inline">\(n = 10^4 ,2 × 10^4 ,4 × 10^4 ,6 ×
10^4 ,8 × 10^4\)</span> , apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1,...,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := nlog(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
<div id="answer" class="section level2">
<h2>Answer</h2>
<ul>
<li>定义快速排序函数</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>qsort <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> x[<span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">1</span>)]</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  left <span class="ot">&lt;-</span> x[x <span class="sc">&lt;</span> pivot]</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>  right <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> pivot]</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">qsort</span>(left), pivot, <span class="fu">qsort</span>(right)))</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>进行模拟并计算平均时间</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#  100 simulations</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  total_time <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>    <span class="fu">qsort</span>(x)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>    total_time <span class="ot">&lt;-</span> total_time <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end_time, start_time, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>  }</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  times[i] <span class="ot">&lt;-</span> total_time <span class="sc">/</span> m</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>计算并进行回归</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>t_values <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>time_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(times <span class="sc">~</span> t_values)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">summary</span>(time_fit)</span></code></pre></div>
<ul>
<li>绘制散点图和回归线</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">n =</span> n_values, <span class="at">times =</span> times, <span class="at">t =</span> t_values), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> times)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;nlog(n)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;平均计算时间&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="question-6.6" class="section level1">
<h1>Question 6.6</h1>
<p>Estimate the <span class="math inline">\(0.025,0.05,0.95\)</span>,
and <span class="math inline">\(0.975\)</span> quantiles of the skewness
<span class="math inline">\(\sqrt b_1\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
the variance of the <span class="math inline">\(q\)</span> sample
quantile <span class="math display">\[Var(\hat{x}_q)=\frac{q(1-q)}{nf(x_q)^2},\]</span>
where <span class="math inline">\(f\)</span> is the density of the
sampled distribution, using the normal approximation for the density
(with exact variance formula). Compare the estimated quantiles with the
quantiles of the large sample approximation <span class="math inline">\(\sqrt b_1\approx N(0,6/n).\)</span></p>
<div id="answer-to-6.6" class="section level2">
<h2>Answer to 6.6</h2>
<ul>
<li>定义计算偏度的函数</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>  mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  std_dev <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x) <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">/</span> n</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  <span class="fu">return</span>(m3 <span class="sc">/</span> std_dev <span class="sc">^</span> <span class="dv">3</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>MC模拟并计算分位数和标准误差</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  skewness_values[i] <span class="ot">&lt;-</span> <span class="fu">skewness</span>(x)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>}</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="co"># 计算分位数和标准误差</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>estimated_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_values, quantiles)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(estimated_quantiles)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>var <span class="ot">&lt;-</span> quantiles <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> quantiles) <span class="sc">/</span> (n <span class="sc">*</span> density <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var)</span></code></pre></div>
<ul>
<li>计算大样本近似的分位数</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>large_sample_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quantiles, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span></code></pre></div>
<ul>
<li>比较结果</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  分位数 <span class="ot">=</span> quantiles,</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  标准差 <span class="ot">=</span> se,</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  估计分位数 <span class="ot">=</span> estimated_quantiles,</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  大样本分位数 <span class="ot">=</span> large_sample_quantiles</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##       分位数     标准差 估计分位数 大样本分位数
## 2.5%   0.025 0.01251513 -0.1498065   -0.1518182
## 5%     0.050 0.01741288 -0.1257532   -0.1274098
## 95%    0.950 0.01741282  0.1257233    0.1274098
## 97.5%  0.975 0.01252137  0.1530960    0.1518182</code></pre>
</div>
</div>
<div id="question-6.b" class="section level1">
<h1>Question 6.B</h1>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in cor.test. Show (empirically) that the nonparametric tests based on
<span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<div id="answer-to-6.b" class="section level2">
<h2>Answer to 6.B</h2>
<ul>
<li>生成二元正态分布数据并进行检验的函数</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>bivariate_normal_test <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>  p_values_Pearson <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  p_values_spearman <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  p_values_kendall <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>    cor_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>    p_values_Pearson[i] <span class="ot">&lt;-</span> cor_res<span class="sc">$</span>p.value</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>    spearman_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>    p_values_spearman[i] <span class="ot">&lt;-</span> spearman_res<span class="sc">$</span>p.value</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>    kendall_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;kendall&#39;</span>)</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>    p_values_kendall[i] <span class="ot">&lt;-</span> kendall_res<span class="sc">$</span>p.value</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>  }</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>    <span class="at">p_values_Pearson =</span> p_values_Pearson,</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>    <span class="at">p_values_spearman =</span> p_values_spearman,</span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>    <span class="at">p_values_kendall =</span> p_values_kendall</span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>  )</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>计算功效的函数</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>compute_power <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values) {</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="fu">mean</span>(p_values <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>定义函数：输出二元正态分布下的检验功效</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>print_power_bivariate_normal <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">bivariate_normal_test</span>(n, m)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  power_Pearson <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_Pearson)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  power_spearman <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_spearman)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  power_kendall <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_kendall)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;在二元正态分布下，样本量为&#39;</span>, n, <span class="st">&#39;，重复次数为&#39;</span>, m, <span class="st">&#39;时：</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Pearson相关检验的功效：&#39;</span>, power_Pearson, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman检验的功效：&#39;</span>, power_spearman, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Kendall检验的功效：&#39;</span>, power_kendall, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>非正态分布的例子：指数分布</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># 生成基于指数分布的数据并进行检验的函数</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>exponential_test <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  p_values_Pearson <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  p_values_spearman <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  p_values_kendall <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>    cor_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>    p_values_Pearson[i] <span class="ot">&lt;-</span> cor_res<span class="sc">$</span>p.value</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>    spearman_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>    p_values_spearman[i] <span class="ot">&lt;-</span> spearman_res<span class="sc">$</span>p.value</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>    kendall_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;kendall&#39;</span>)</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>    p_values_kendall[i] <span class="ot">&lt;-</span> kendall_res<span class="sc">$</span>p.value</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  }</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>    <span class="at">p_values_Pearson =</span> p_values_Pearson,</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>    <span class="at">p_values_spearman =</span> p_values_spearman,</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>    <span class="at">p_values_kendall =</span> p_values_kendall</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  )</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>定义函数：输出非二元正态分布下的检验功效</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>print_power_exponential <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">exponential_test</span>(n, m)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  power_Pearson <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_Pearson)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  power_spearman <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_spearman)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  power_kendall <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(test_results<span class="sc">$</span>p_values_kendall)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;在非正态分布下，样本量为&#39;</span>, n, <span class="st">&#39;，重复次数为&#39;</span>, m, <span class="st">&#39;时：</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Pearson相关检验的功效：&#39;</span>, power_Pearson, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman检验的功效：&#39;</span>, power_spearman, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Kendall检验的功效：&#39;</span>, power_kendall, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>报告结论</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="fu">print_power_bivariate_normal</span>(n, m)<span class="co"># 二元正态分布</span></span></code></pre></div>
<pre><code>## 在二元正态分布下，样本量为 100 ，重复次数为 1000 时：
## Pearson相关检验的功效： 0.054 
## Spearman检验的功效： 0.051 
## Kendall检验的功效： 0.048</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">print_power_exponential</span>(n, m)<span class="co"># 非正态分布</span></span></code></pre></div>
<pre><code>## 在非正态分布下，样本量为 100 ，重复次数为 1000 时：
## Pearson相关检验的功效： 0.047 
## Spearman检验的功效： 0.048 
## Kendall检验的功效： 0.046</code></pre>
<ul>
<li><p>根据结论，发现</p>
<ul>
<li>Nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.</li>
<li>在指数分布下，at least one of the nonparametric tests have better
empirical power than the correlation test against this alternative.</li>
</ul></li>
</ul>
</div>
</div>
<div id="question-on-ppt" class="section level1">
<h1>Question on PPT</h1>
<p>If we obtain the powers for two methods under a particular simulation
setting with <span class="math inline">\(10,000\)</span> experiments:
say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. We want to know
if the powers are different at <span class="math inline">\(0.05\)</span>
level. - What is the corresponding hypothesis test problem? - What test
should we use? Z-test, two-sample t-test, paired-t test or McNemar test?
Why? - Please provide the least necessary information for hypothesis
testing.</p>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<ul>
<li><p>What is the corresponding hypothesis test problem? <span class="math display">\[H_0: p_1 = p_2 \longleftrightarrow H_1: p_1 \neq
p_2\]</span></p></li>
<li><p>What test should we use?</p>
<ul>
<li>应使用 Z 检验</li>
<li>因为这是对两个独立样本比例的比较，样本量较大（10,000 次实验），符合
Z 检验的条件</li>
</ul></li>
<li><p>Provide the least necessary information for hypothesis
testing</p>
<ul>
<li>两种方法的功效估计值（<span class="math inline">\(\hat
p_1=0.651\)</span> 和 <span class="math inline">\(\hat
p_2=0.676\)</span>）</li>
<li>样本量（10,000 次实验）</li>
<li>显著性水平（0.05）</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># 计算 Z 统计量</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.651</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.676</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">/</span> n)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>se2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2) <span class="sc">/</span> n)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(se1 <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> se2 <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>z <span class="ot">&lt;-</span> (p2 <span class="sc">-</span> p1) <span class="sc">/</span> se</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a><span class="co"># 计算 P 值</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z))</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a><span class="co"># 判断是否拒绝零假设</span></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;p=&#39;</span>, p_value,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## p= 0.0001821846</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;在 0.05 水平上，两种方法的功效有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;在 0.05 水平上，两种方法的功效没有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 在 0.05 水平上，两种方法的功效有显著差异。</code></pre>
</div>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>Of N =1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level <span class="math inline">\(\alpha =0.1\)</span>
for each of the two adjustment methods based on m=10000 simulation
replicates. You should output the 6 numbers (3) to a 3×2 table (column
names: Bonferroni correction, B-H correction; row names: FWER, FDR,
TPR). Comment the results.</p>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a><span class="co"># 循环生成模拟的 p 值</span></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> N)</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>    <span class="cf">if</span> (j <span class="sc">&lt;=</span> n0) {</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>      p_values[i, j] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>      p_values[i, j] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>    }</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>  }</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>}</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a></span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a><span class="co"># 调整后的 p 值</span></span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a>p_bonferroni <span class="ot">&lt;-</span> p_values <span class="sc">*</span> N</span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>p_bh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> N)</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb66-24"><a href="#cb66-24" tabindex="-1"></a>  sorted_p <span class="ot">&lt;-</span> <span class="fu">sort</span>(p_values[i, ])</span>
<span id="cb66-25"><a href="#cb66-25" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb66-26"><a href="#cb66-26" tabindex="-1"></a>    p_bh[i, j] <span class="ot">&lt;-</span> sorted_p[j] <span class="sc">*</span> N <span class="sc">/</span> (j)</span>
<span id="cb66-27"><a href="#cb66-27" tabindex="-1"></a>  }</span>
<span id="cb66-28"><a href="#cb66-28" tabindex="-1"></a>}</span>
<span id="cb66-29"><a href="#cb66-29" tabindex="-1"></a></span>
<span id="cb66-30"><a href="#cb66-30" tabindex="-1"></a><span class="co"># 计算</span></span>
<span id="cb66-31"><a href="#cb66-31" tabindex="-1"></a>FWER_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(p_bonferroni <span class="sc">&lt;=</span> alpha) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb66-32"><a href="#cb66-32" tabindex="-1"></a>FDR_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(p_bonferroni <span class="sc">&lt;=</span> alpha, <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb66-33"><a href="#cb66-33" tabindex="-1"></a>  <span class="fu">mean</span>(p_values[x, ] <span class="sc">&lt;=</span> alpha <span class="sc">/</span> N)))</span>
<span id="cb66-34"><a href="#cb66-34" tabindex="-1"></a>TPR_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(p_bonferroni <span class="sc">&lt;=</span> alpha, <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb66-35"><a href="#cb66-35" tabindex="-1"></a>  <span class="fu">mean</span>(p_values[x, (n0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">&lt;=</span> alpha <span class="sc">/</span> N)))</span>
<span id="cb66-36"><a href="#cb66-36" tabindex="-1"></a></span>
<span id="cb66-37"><a href="#cb66-37" tabindex="-1"></a>FWER_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(p_bh <span class="sc">&lt;=</span> alpha) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb66-38"><a href="#cb66-38" tabindex="-1"></a>FDR_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(p_bh <span class="sc">&lt;=</span> alpha, <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb66-39"><a href="#cb66-39" tabindex="-1"></a>  <span class="fu">mean</span>(p_values[x, ] <span class="sc">&lt;=</span> alpha <span class="sc">/</span> N)))</span>
<span id="cb66-40"><a href="#cb66-40" tabindex="-1"></a>TPR_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(p_bh <span class="sc">&lt;=</span> alpha, <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb66-41"><a href="#cb66-41" tabindex="-1"></a>  <span class="fu">mean</span>(p_values[x, (n0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">&lt;=</span> alpha <span class="sc">/</span> N)))</span>
<span id="cb66-42"><a href="#cb66-42" tabindex="-1"></a></span>
<span id="cb66-43"><a href="#cb66-43" tabindex="-1"></a><span class="co"># 结果</span></span>
<span id="cb66-44"><a href="#cb66-44" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb66-45"><a href="#cb66-45" tabindex="-1"></a>  <span class="fu">c</span>(FWER_bonferroni, FWER_bh, FDR_bonferroni, FDR_bh, TPR_bonferroni, TPR_bh),</span>
<span id="cb66-46"><a href="#cb66-46" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb66-47"><a href="#cb66-47" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb66-48"><a href="#cb66-48" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">FALSE</span></span>
<span id="cb66-49"><a href="#cb66-49" tabindex="-1"></a>)</span>
<span id="cb66-50"><a href="#cb66-50" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb66-51"><a href="#cb66-51" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb66-52"><a href="#cb66-52" tabindex="-1"></a>result</span></code></pre></div>
<ul>
<li>Bonferroni 校正结果分析
<ul>
<li>FWER：Bonferroni 校正后的 FWER
为1.0000000，这意味着在所有模拟中，几乎每次都至少错误地拒绝了一个零假设。这表明
Bonferroni
校正可能过于保守，导致在控制整体错误率时过于严格，使得即使在没有真正效应的情况下，也很容易拒绝零假设。</li>
<li>FDR：FDR 为
1.0000000，说明在被拒绝的假设中，几乎所有都是错误的发现。这进一步说明了
Bonferroni
校正的保守性，它可能将很多实际上可能为真的备择假设也判定为错误，从而导致错误发现率极高。</li>
<li>TPR：TPR 为
0.0198133，非常低。这意味正确拒绝零假设找到备择假设为真的情况很少被检测到。Bonferroni
校正的严格性使得它在控制错误率的同时，牺牲了对真正效应的检测能力。</li>
</ul></li>
<li>B - H 校正结果分析
<ul>
<li>FWER：B - H 校正后的 FWER 为 0.01989188，相对 Bonferroni
校正要低很多，说明 B - H 校正能够较好地控制整体错误率，不会像 Bonferroni
校正那样过于频繁地错误拒绝零假设。</li>
<li>FDR：FDR 为 0.39458600，虽然不是很低，但相比于 Bonferroni 校正的
1.0000000 有了很大改善。这表明 B - H
校正能够在一定程度上控制错误发现率，在允许一些错误发现的同时，也能找到一些真正的效应。</li>
<li>TPR：TPR 为 0.39633916，相对 Bonferroni 校正的结果要高很多。这说明 B
- H
校正能够更好地检测到备择假设为真的情况，在控制错误率的同时，保持了对真正效应的一定检测能力。
总体而言，Bonferroni
校正过于保守，虽然严格控制了错误率，但牺牲了对真正效应的检测能力；而 B -
H
校正相对更为合理，在控制错误率和检测真正效应之间取得了较好的平衡。</li>
</ul></li>
</ul>
</div>
</div>
<div id="question-7.4" class="section level1">
<h1>Question 7.4</h1>
<p>Refer to the air-conditioning data set <code>aircondit</code>
provided in the boot package. The 12 observations are the times in hours
between failures of air-conditioning equipment: <span class="math display">\[3,5,7,18,43,85,91,98,100,130,230,487.\]</span>
Assume that the times between failures follow an exponential model
Exp<span class="math inline">\((\lambda)\)</span>. Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
<div id="answer-to-7.4" class="section level2">
<h2>Answer to 7.4</h2>
<p>指数分布的概率密度函数为 <span class="math display">\[f(x)=\lambda
e^{-\lambda x}\]</span> 其中 <span class="math inline">\(x\geq0\)</span>，<span class="math inline">\(\lambda&gt;0\)</span>。对于一组独立同分布的样本
<span class="math inline">\(x_1,x_2,\cdots,x_n\)</span>，其似然函数为
<span class="math display">\[L(\lambda)=\prod_{i=1}^{n}\lambda
e^{-\lambda x_i}=\lambda^n exp\{-\lambda\sum_{i=1}^{n}x_i\}\]</span>
对数似然函数为 <span class="math display">\[l(\lambda)=n\log(\lambda)-\lambda\sum_{i=1}^{n}x_i\]</span>
对对数似然函数求导并令其为 0，可得： <span class="math display">\[\frac{\partial
l(\lambda)}{\partial\lambda}=\frac{n}{\lambda}-\sum_{i=1}^{n}x_i=0\]</span>
解出极大似然估计值 <span class="math display">\[\hat{\lambda}=\frac{n}{\sum_{i=1}^{n}x_i}\]</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="co"># 危险率lambda的极大似然估计值</span></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(times)</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(times)</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of the hazard rate lambda：&quot;</span>, lambda_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of the hazard rate lambda： 0.00925212</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="co"># Bootstrap</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 设置自助抽样次数</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>lambda_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(times, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  lambda_boot[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(boot_sample)<span class="sc">/</span><span class="fu">sum</span>(boot_sample)</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>}</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_boot) <span class="sc">-</span> lambda_hat</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_boot)</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bias:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bias: 0.001582967</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard error:&quot;</span>, se)</span></code></pre></div>
<pre><code>## Standard error: 0.004452266</code></pre>
</div>
</div>
<div id="question-7.5" class="section level1">
<h1>Question 7.5</h1>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div id="answer-to-7.5" class="section level2">
<h2>Answer to 7.5</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="co"># 计算平均故障间隔时间</span></span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>mean_time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lambda_hat</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a><span class="co"># 计算 95%置信区间</span></span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a><span class="do">## 标准正态方法</span></span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>normal_interval <span class="ot">&lt;-</span> mean_time <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>z <span class="sc">*</span> se, z <span class="sc">*</span> se) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>lambda_hat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a><span class="do">## 基本方法</span></span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>basic_interval <span class="ot">&lt;-</span> <span class="fu">quantile</span>(lambda_boot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a>basic_interval <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>basic_interval</span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a><span class="do">## 百分位数方法</span></span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>percentile_interval <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">/</span>lambda_boot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a><span class="do">## BCa方法</span></span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a>boot_obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> times, <span class="at">statistic =</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x[i])</span>
<span id="cb73-20"><a href="#cb73-20" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">/</span><span class="fu">sum</span>(x[i]))</span>
<span id="cb73-21"><a href="#cb73-21" tabindex="-1"></a>}, <span class="at">R =</span> B)</span>
<span id="cb73-22"><a href="#cb73-22" tabindex="-1"></a>bca_interval <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_obj, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb73-23"><a href="#cb73-23" tabindex="-1"></a>bca_interval <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>bca_interval</span>
<span id="cb73-24"><a href="#cb73-24" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;标准正态法 95%置信区间：[&quot;</span>, normal_interval[<span class="dv">1</span>], <span class="st">&quot;,&quot;</span>, normal_interval[<span class="dv">2</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 标准正态法 95%置信区间：[ 6.142867 , 210.0238 ]</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;基本方法 95%置信区间：[&quot;</span>, basic_interval[<span class="dv">2</span>], <span class="st">&quot;,&quot;</span>, basic_interval[<span class="dv">1</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 基本方法 95%置信区间：[ 47.39331 , 193.5167 ]</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分位数法 95%置信区间：[&quot;</span>, percentile_interval[<span class="dv">1</span>], <span class="st">&quot;,&quot;</span>, percentile_interval[<span class="dv">2</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 分位数法 95%置信区间：[ 47.39375 , 193.5187 ]</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa法 95%置信区间：[&quot;</span>, bca_interval[<span class="dv">2</span>], <span class="st">&quot;,&quot;</span>, bca_interval[<span class="dv">1</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa法 95%置信区间：[ 56.25 , 212.0832 ]</code></pre>
<ul>
<li>不同方法计算的置信区间可能不同的原因主要有以下几点：
<ul>
<li>标准正态法基于大样本理论和正态分布假设，对数据分布有较强的要求。如果数据不满足正态分布，该方法的准确性可能受到影响。</li>
<li>基本方法和分位数法相对简单直接，但对抽样分布的形状假设较少，可能在样本量较小时不够准确。</li>
<li>BCa
方法通过调整百分位数方法，考虑了估计量的偏度和抽样分布的不对称性，通常在各种情况下更加准确和稳健。</li>
</ul></li>
</ul>
</div>
</div>
<div id="question-7.8" class="section level1">
<h1>Question 7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div id="answer-to-7.8" class="section level2">
<h2>Answer to 7.8</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>sc<span class="ot">&lt;-</span>scor</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="co"># 计算theta的函数</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>estimate_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>    <span class="fu">cov</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>    <span class="fu">prcomp</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>    {.<span class="sc">$</span>sdev[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(.<span class="sc">$</span>sdev)}</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>}</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(sc)</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>theta.j<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){    </span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>  theta.j[i]<span class="ot">&lt;-</span><span class="fu">estimate_theta</span>(sc[<span class="sc">-</span>i,])</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>}</span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">estimate_theta</span>(sc)</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.j)<span class="sc">-</span>theta.hat) <span class="co">#BIAS</span></span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(theta.j)) <span class="co">#SE</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a></span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bias:&quot;</span>, <span class="fu">round</span>(bias,<span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bias: 0.014</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard error:&quot;</span>, <span class="fu">round</span>(se,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## standard error: 0.053</code></pre>
</div>
</div>
<div id="question-7.10" class="section level1">
<h1>Question 7.10</h1>
<p>In Example 7.18, leave-one-out <span class="math inline">\((n\)</span>-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2?\)</span></p>
<div id="answer-to-7.10" class="section level2">
<h2>Answer to 7.10</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a></span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a></span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a>}</span>
<span id="cb85-28"><a href="#cb85-28" tabindex="-1"></a></span>
<span id="cb85-29"><a href="#cb85-29" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]      19.556      17.852      18.442 2155967.354</code></pre>
<p>CV表明，选择二次模型</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># 函数：拟合模型，返回模型列表</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>fit_models <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x) {</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>  L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>  L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">3</span>))</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(L1, L2, L3, L4))</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>}</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a><span class="co"># maximum adjusted R^2 选择模型</span></span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a><span class="fu">fit_models</span>(magnetic, chemical) <span class="sc">%&gt;%</span></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>  <span class="fu">sapply</span>(., <span class="cf">function</span>(model)</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Adjusted-R^2:</span><span class="sc">\n</span><span class="st">&quot;</span>, .)</span></code></pre></div>
<pre><code>## Adjusted-R^2:
##  0.528 0.577 0.528 0.574</code></pre>
<p>adjust-R^2表明，选择二次模型</p>
</div>
</div>
<div id="question-8.1" class="section level1">
<h1>Question 8.1</h1>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div id="answer-to-8.1" class="section level2">
<h2>Answer to 8.1</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co"># 计算 Cramer-von Mises 统计量</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>cvm_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>  term1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">Fn</span>(x) <span class="sc">-</span> <span class="fu">Gm</span>(x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>  term2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">Fn</span>(y) <span class="sc">-</span> <span class="fu">Gm</span>(y)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>  <span class="fu">return</span>((m <span class="sc">*</span> n) <span class="sc">/</span> (m <span class="sc">+</span> n) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (term1 <span class="sc">+</span> term2))</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>}</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a><span class="co"># 置换检验函数</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="dv">1000</span>) {</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cvm_stat</span>(x, y)</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>    permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>    x_perm <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>    y_perm <span class="ot">&lt;-</span> permuted[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)]</span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>    stats[i] <span class="ot">&lt;-</span> <span class="fu">cvm_stat</span>(x_perm, y_perm)</span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a>  }</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(stats <span class="sc">&gt;=</span> observed_stat)</span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed_statistic =</span> observed_stat, <span class="at">p_value =</span> p_value))</span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a>}</span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a></span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a><span class="co"># 结果打印函数</span></span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a>print_permutation_test_result <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a>  <span class="fu">permutation_test</span>(x, y)<span class="sc">$</span>observed_statistic <span class="sc">%&gt;%</span></span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Observed Cramer-von Mises statistic:&quot;</span>, ., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">permutation_test</span>(x, y)<span class="sc">$</span>p_value</span>
<span id="cb89-35"><a href="#cb89-35" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb89-36"><a href="#cb89-36" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb89-37"><a href="#cb89-37" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;p &lt; 0.05，拒绝原假设。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb89-38"><a href="#cb89-38" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb89-39"><a href="#cb89-39" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;p &gt; 0.05，不能拒绝原假设</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb89-40"><a href="#cb89-40" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Examples 8.1 and 8.2</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>eg_x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>eg_y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a><span class="fu">print_permutation_test_result</span>(eg_x, eg_y)</span></code></pre></div>
<pre><code>## Observed Cramer-von Mises statistic: 0.1515216 
## P-value: 0.394 
## p &gt; 0.05，不能拒绝原假设</code></pre>
<p>基于本次 Cramer-von Mises
检验的结果，不能得出示例中的两个样本（大豆组和亚麻籽组的小鸡体重数据）来自不同分布的结论，即可以认为这两个组的小鸡体重分布可能是相似的。</p>
</div>
</div>
<div id="question-8.2" class="section level1">
<h1>Question 8.2</h1>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function <code>cor</code> with
<code>method = &quot;spearman&quot;</code>. Compare the achieved significance
level of the permutation test with the p-value reported by cor.test on
the same samples.</p>
<div id="answer-to-8.2" class="section level2">
<h2>Answer to 8.2</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># 置换检验函数</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>permutation_test_spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="dv">1000</span>) {</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>    permuted_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>    stats[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, permuted_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a>  }</span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_stat))</span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed_statistic =</span> observed_stat, <span class="at">p_value =</span> p_value))</span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a>}</span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a><span class="co"># 生成随机数据</span></span>
<span id="cb92-15"><a href="#cb92-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb92-16"><a href="#cb92-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>)</span>
<span id="cb92-17"><a href="#cb92-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>)</span>
<span id="cb92-18"><a href="#cb92-18" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" tabindex="-1"></a>perm_result <span class="ot">&lt;-</span> <span class="fu">permutation_test_spearman</span>(x, y)</span>
<span id="cb92-20"><a href="#cb92-20" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-21"><a href="#cb92-21" tabindex="-1"></a></span>
<span id="cb92-22"><a href="#cb92-22" tabindex="-1"></a><span class="co"># 结果打印</span></span>
<span id="cb92-23"><a href="#cb92-23" tabindex="-1"></a><span class="fu">round</span>(perm_result<span class="sc">$</span>observed_statistic, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-24"><a href="#cb92-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Observed Spearman correlation statistic from permutation test:&quot;</span>,</span>
<span id="cb92-25"><a href="#cb92-25" tabindex="-1"></a>      .,</span>
<span id="cb92-26"><a href="#cb92-26" tabindex="-1"></a>      <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed Spearman correlation statistic from permutation test: 0.081</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">round</span>(perm_result<span class="sc">$</span>p_value, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value from permutation test:&quot;</span>, ., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from permutation test: 0.005</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">round</span>(cor_test_result<span class="sc">$</span>p.value, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value from cor.test:&quot;</span>, ., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from cor.test: 0.01</code></pre>
</div>
</div>
<div id="question-9.3" class="section level1">
<h1>Question 9.3</h1>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see <code>qcauchy</code> or
<code>qt</code> with <span class="math inline">\(df=1\)</span>). Recall
that a Cauchy<span class="math inline">\((\theta,\eta)\)</span>
distribution has density function</p>
<p><span class="math display">\[f(x)=\frac1{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad-\infty&lt;x&lt;\infty,\:\theta&gt;0.\]</span></p>
<p>The standard Cauchy has the Cauchy<span class="math inline">\((\theta=1,\eta=0)\)</span> density. (Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom.)</p>
<div id="answer-to-9.3" class="section level2">
<h2>Answer to 9.3</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="co"># 目标密度函数（标准柯西分布）</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>target_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>}</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a><span class="co"># Metropolis-Hastings</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(start_value, iterations) {</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>  current <span class="ot">&lt;-</span> start_value</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iterations) {</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, current, <span class="dv">1</span>)</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">target_density</span>(proposal) <span class="sc">/</span> <span class="fu">target_density</span>(current)</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>      current <span class="ot">&lt;-</span> proposal</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>    }</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> current</span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>  }</span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mcmc</span>(samples))</span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a>}</span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a><span class="co"># Metropolis-Hastings并监测收敛</span></span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a>run_and_monitor <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a>  n_chains <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a>  chain_length <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a>    chains[[i]] <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>), chain_length)</span>
<span id="cb98-30"><a href="#cb98-30" tabindex="-1"></a>  }</span>
<span id="cb98-31"><a href="#cb98-31" tabindex="-1"></a>  combined_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(chains)</span>
<span id="cb98-32"><a href="#cb98-32" tabindex="-1"></a>  gelman_rubin <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(combined_chains, <span class="at">multivariate =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>psrf[<span class="dv">1</span>]</span>
<span id="cb98-33"><a href="#cb98-33" tabindex="-1"></a>  <span class="cf">while</span> (gelman_rubin <span class="sc">&gt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb98-34"><a href="#cb98-34" tabindex="-1"></a>    new_chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb98-35"><a href="#cb98-35" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb98-36"><a href="#cb98-36" tabindex="-1"></a>      new_chains[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(chains[[i]], <span class="fu">metropolis_hastings</span>(chains[[i]][<span class="fu">length</span>(chains[[i]])], chain_length))</span>
<span id="cb98-37"><a href="#cb98-37" tabindex="-1"></a>    }</span>
<span id="cb98-38"><a href="#cb98-38" tabindex="-1"></a>    chains <span class="ot">&lt;-</span> new_chains</span>
<span id="cb98-39"><a href="#cb98-39" tabindex="-1"></a>    combined_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(chains)</span>
<span id="cb98-40"><a href="#cb98-40" tabindex="-1"></a>    gelman_rubin <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(combined_chains, <span class="at">multivariate =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>psrf[<span class="dv">1</span>]</span>
<span id="cb98-41"><a href="#cb98-41" tabindex="-1"></a>  }</span>
<span id="cb98-42"><a href="#cb98-42" tabindex="-1"></a>  <span class="fu">return</span>(chains)</span>
<span id="cb98-43"><a href="#cb98-43" tabindex="-1"></a>}</span>
<span id="cb98-44"><a href="#cb98-44" tabindex="-1"></a></span>
<span id="cb98-45"><a href="#cb98-45" tabindex="-1"></a><span class="co"># 结果输出</span></span>
<span id="cb98-46"><a href="#cb98-46" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">run_and_monitor</span>()</span>
<span id="cb98-47"><a href="#cb98-47" tabindex="-1"></a>all_samples <span class="ot">&lt;-</span> <span class="fu">unlist</span>(chains)</span>
<span id="cb98-48"><a href="#cb98-48" tabindex="-1"></a>trimmed_samples <span class="ot">&lt;-</span> all_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]</span>
<span id="cb98-49"><a href="#cb98-49" tabindex="-1"></a>generated_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(trimmed_samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb98-50"><a href="#cb98-50" tabindex="-1"></a>true_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb98-51"><a href="#cb98-51" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;生成的观测值十分位数：&quot;</span>, generated_deciles, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 生成的观测值十分位数： -12.42122 -2.73033 -1.203038 -0.5718276 -0.1638357 0.1920756 0.5787829 1.151329 2.837363</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;标准柯西分布十分位数：&quot;</span>, true_deciles, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 标准柯西分布十分位数： -3.077684 -1.376382 -0.7265425 -0.3249197 0 0.3249197 0.7265425 1.376382 3.077684</code></pre>
</div>
</div>
<div id="question-9.8" class="section level1">
<h1>Question 9.8</h1>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,1,\ldots,n,\:0\leq y\leq1.\]</span></p>
<p>It can be shown that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
Binomial<span class="math inline">\((n,y)\)</span> and Beta<span class="math inline">\((x+a,n-x+b).\)</span> Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y).\)</span></p>
<div id="answer-to-9.8" class="section level2">
<h2>Answer to 9.8</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>  <span class="co"># 一般二项式系数</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>  <span class="fu">gamma</span>(n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="fu">gamma</span>(x <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">gamma</span>(n <span class="sc">-</span> x <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> y <span class="sc">^</span> (x <span class="sc">+</span> a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">^</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>    (n <span class="sc">-</span> x <span class="sc">+</span> b <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>}</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a><span class="co"># Gibbs 采样函数</span></span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">niter =</span> <span class="dv">10000</span>) {</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> niter, <span class="at">ncol =</span> d)</span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fl">0.1</span>, <span class="at">nrow =</span> niter, <span class="at">ncol =</span> d)</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a>  </span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>niter) {</span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>    x1[i, ] <span class="ot">&lt;-</span> x1[i <span class="sc">-</span> <span class="dv">1</span>, ] <span class="sc">%&gt;%</span> {</span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a>     .[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n,.[<span class="dv">2</span>])</span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a>     .[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,.[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span>.[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a>     .</span>
<span id="cb102-18"><a href="#cb102-18" tabindex="-1"></a>    }</span>
<span id="cb102-19"><a href="#cb102-19" tabindex="-1"></a>    x2[i, ] <span class="ot">&lt;-</span> x2[i <span class="sc">-</span> <span class="dv">1</span>, ] <span class="sc">%&gt;%</span> {</span>
<span id="cb102-20"><a href="#cb102-20" tabindex="-1"></a>     .[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n,.[<span class="dv">2</span>])</span>
<span id="cb102-21"><a href="#cb102-21" tabindex="-1"></a>     .[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,.[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span>.[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb102-22"><a href="#cb102-22" tabindex="-1"></a>     .</span>
<span id="cb102-23"><a href="#cb102-23" tabindex="-1"></a>    }</span>
<span id="cb102-24"><a href="#cb102-24" tabindex="-1"></a>  }</span>
<span id="cb102-25"><a href="#cb102-25" tabindex="-1"></a>  chain1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(x1)</span>
<span id="cb102-26"><a href="#cb102-26" tabindex="-1"></a>  chain2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(x2)</span>
<span id="cb102-27"><a href="#cb102-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mcmc.list</span>(chain1, chain2))</span>
<span id="cb102-28"><a href="#cb102-28" tabindex="-1"></a>}</span>
<span id="cb102-29"><a href="#cb102-29" tabindex="-1"></a></span>
<span id="cb102-30"><a href="#cb102-30" tabindex="-1"></a><span class="co"># 结果</span></span>
<span id="cb102-31"><a href="#cb102-31" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb102-32"><a href="#cb102-32" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb102-33"><a href="#cb102-33" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb102-34"><a href="#cb102-34" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb102-35"><a href="#cb102-35" tabindex="-1"></a>converged <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb102-36"><a href="#cb102-36" tabindex="-1"></a><span class="cf">while</span> (<span class="sc">!</span>converged) {</span>
<span id="cb102-37"><a href="#cb102-37" tabindex="-1"></a>  combined_chain <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>() <span class="sc">%&gt;%</span> <span class="fu">gelman.diag</span>()</span>
<span id="cb102-38"><a href="#cb102-38" tabindex="-1"></a>  <span class="cf">if</span> (combined_chain<span class="sc">$</span>mpsrf[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb102-39"><a href="#cb102-39" tabindex="-1"></a>    converged <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb102-40"><a href="#cb102-40" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb102-41"><a href="#cb102-41" tabindex="-1"></a>    combined_chain <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>()</span>
<span id="cb102-42"><a href="#cb102-42" tabindex="-1"></a>  }</span>
<span id="cb102-43"><a href="#cb102-43" tabindex="-1"></a>}</span>
<span id="cb102-44"><a href="#cb102-44" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gibbs 采样收敛情况：&quot;</span>, converged, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Gibbs 采样收敛情况： TRUE</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;目标联合密度函数中的参数 n =&quot;</span>, n, <span class="st">&quot;, a =&quot;</span>, a, <span class="st">&quot;, b =&quot;</span>, b, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 目标联合密度函数中的参数 n = 100 , a = 2 , b = 3</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;生成的马尔可夫链中前几个样本点（x,y）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 生成的马尔可夫链中前几个样本点（x,y）：</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">head</span>(combined_chain[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##      Point est. Upper C.I.
## [1,]   1.008135   1.011828
## [2,]   1.007991   1.011209</code></pre>
</div>
</div>
<div id="proof-the-stationarity-of-metropolis-hastings-sampler-algorithm-in-continuous-situation." class="section level1">
<h1>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</h1>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<ul>
<li>当<span class="math inline">\(s = r\)</span>时： <span class="math display">\[K(s,r)f(s)=[1-\int\alpha(r,s)g(s|r)]f(s)\]</span>
<span class="math display">\[K(r,s)f(r)=[1-\int\alpha(s,r)g(r|s)]f(r)\]</span>
由 <span class="math display">\[\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\},\quad\alpha(r,s)=\min\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\}\]</span>
<span class="math display">\[\int\alpha(r,s)g(s|r)=\int\alpha(s,r)g(r|s)\]</span>
则 <span class="math display">\[K(s,r)f(s)=K(r,s)f(r)\]</span></li>
<li>当<span class="math inline">\(s\neq r\)</span>时： <span class="math display">\[K(s,r)f(s)=\alpha(s,r)g(r|s)f(s)\]</span> <span class="math display">\[K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)\]</span> 由
<span class="math display">\[\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\},\quad\alpha(r,s)=\min\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\}\]</span>
可得：
<ul>
<li>如果<span class="math inline">\(\displaystyle\frac{f(r)g(s|r)}{f(s)g(r|s)}\leq1\)</span>，则
<span class="math display">\[\alpha(s,r)=\frac{f(r)g(s|r)}{f(s)g(r|s)},\quad\alpha(r,s)
= 1\]</span> 此时 <span class="math display">\[K(s,r)f(s)=\frac{f(r)g(s|r)}{f(s)g(r|s)}g(r|s)f(s)=f(r)g(s|r)\]</span>
<span class="math display">\[K(r,s)f(r)=g(s|r)f(r)\]</span> 所以 <span class="math display">\[K(s,r)f(s)=K(r,s)f(r)\]</span></li>
<li>如果<span class="math inline">\(\displaystyle\frac{f(r)g(s|r)}{f(s)g(r|s)}\gt1\)</span>，则
<span class="math display">\[\alpha(s,r)=1,\quad\alpha(r,s)=\frac{f(s)g(r|s)}{f(r)g(s|r)}\]</span>
此时 <span class="math display">\[K(s,r)f(s)=g(r|s)f(s)\]</span> <span class="math display">\[K(r,s)f(r)=\frac{f(s)g(r|s)}{f(r)g(s|r)}g(s|r)f(r)=g(r|s)f(s)\]</span>
所以 <span class="math display">\[K(s,r)f(s)=K(r,s)f(r)\]</span></li>
</ul></li>
</ul>
<p>综上，在连续情况下Metropolis - Hastings sampler满足平稳性<span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>。</p>
</div>
</div>
<div id="question-11.3" class="section level1">
<h1>Question 11.3</h1>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in</li>
</ol>
<p><span class="math display">\[\sum_{k=0}^\infty\frac{(-1)^k}{k!\:2^k}\frac{\left\|a\right\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},\]</span></p>
<p>where <span class="math inline">\(d\geq1\)</span> is an integer,
<span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d.\)</span> (This sum converges for all
<span class="math inline">\(a\in\mathbb{R}^d).\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a=(1,2)^T.\)</span></p></li>
</ol>
<div id="answer-to-11.3" class="section level2">
<h2>Answer to 11.3</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co"># function to compute the kth term</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a) {</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># Euclidean norm</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>  term <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k) <span class="sc">*</span> (norm_a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>    <span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>}</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a><span class="co"># function to compute sum</span></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">tol =</span> <span class="fl">1e-10</span>) {</span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># Euclidean norm</span></span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  sum_series <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>  term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, a)</span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(term) <span class="sc">&gt;</span> tol) {</span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a>    sum_series <span class="ot">&lt;-</span> sum_series <span class="sc">+</span> term</span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb110-19"><a href="#cb110-19" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, a)</span>
<span id="cb110-20"><a href="#cb110-20" tabindex="-1"></a>  }</span>
<span id="cb110-21"><a href="#cb110-21" tabindex="-1"></a>  <span class="fu">return</span>(sum_series)</span>
<span id="cb110-22"><a href="#cb110-22" tabindex="-1"></a>}</span>
<span id="cb110-23"><a href="#cb110-23" tabindex="-1"></a></span>
<span id="cb110-24"><a href="#cb110-24" tabindex="-1"></a><span class="co"># Evaluate the sum when a=(1,2)</span></span>
<span id="cb110-25"><a href="#cb110-25" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb110-26"><a href="#cb110-26" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">compute_sum</span>(a)</span>
<span id="cb110-27"><a href="#cb110-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;sum when a = (1,2) :&#39;</span>, result)</span></code></pre></div>
<pre><code>## sum when a = (1,2) : 1.532164</code></pre>
</div>
</div>
<div id="question-11.5" class="section level1">
<h1>Question 11.5</h1>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[\begin{aligned}\frac{2\Gamma(\frac
k2)}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}2)}&amp;\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k/2}du\\&amp;=\frac{2\Gamma(\frac{k+1}2)}{\sqrt{\pi
k}\Gamma(\frac
k2)}\int_0^{c_k}\left(1+\frac{u^2}k\right)^{-(k+1)/2}du\end{aligned}\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where</p>
<p><span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<div id="answer-to-11.5" class="section level2">
<h2>Answer to 11.5</h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co"># 定义方程的函数</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>define_equation <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a){</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  int_func <span class="ot">&lt;-</span> <span class="cf">function</span>(u, n){(<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  get_c <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a){<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  expr <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>    this_int_func <span class="ot">&lt;-</span> <span class="cf">function</span>(u){</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>      <span class="fu">int_func</span>(u, n)}</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>    c_val <span class="ot">&lt;-</span> <span class="fu">get_c</span>(n <span class="sc">-</span> <span class="dv">1</span>, a)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> </span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>      <span class="fu">integrate</span>(this_int_func, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c_val)<span class="sc">$</span>value}</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>  </span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>  lhs <span class="ot">&lt;-</span> <span class="fu">expr</span>(k, a)</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="fu">expr</span>(k <span class="sc">+</span> <span class="dv">1</span>, a)</span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a>  <span class="fu">return</span>(lhs <span class="sc">-</span> rhs)</span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>}</span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a></span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a><span class="co"># 解方程的函数</span></span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a>solve_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a){<span class="fu">return</span>(<span class="fu">define_equation</span>(k, a))}</span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">1e-2</span></span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">f</span>(eps) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> eps) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">f</span>(eps) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> eps) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(eps, <span class="fu">sqrt</span>(k) <span class="sc">-</span> eps))<span class="sc">$</span>root)</span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a>  }</span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a>}</span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a></span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a><span class="co"># 结果输出</span></span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a>r11<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span>(k) {</span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a>  <span class="fu">solve_eq</span>(k) <span class="sc">%&gt;%</span> </span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a>})</span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a>r11<span class="fl">.5</span></span></code></pre></div>
<pre><code>##  [1] 1.492073 1.533555 1.562745 1.584429 1.601184 1.614516 1.625389 1.634418
##  [9] 1.642026 1.648552 1.654175 1.659099 1.663454 1.667287       NA 1.673832
## [17] 1.676605 1.679148 1.681468 1.683593 1.685546 1.687366       NA       NA
## [25] 1.730903</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="co"># EX 11.4</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>findIntersection <span class="ot">=</span> <span class="cf">function</span> (k) {</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  s_k.minus.one <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>)), <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)}</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  s_k <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>)), <span class="at">df =</span> k)}</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>  f <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="fu">s_k</span>(a) <span class="sc">-</span> <span class="fu">s_k.minus.one</span>(a)}</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>  </span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>  eps <span class="ot">=</span> <span class="fl">1e-2</span></span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(eps, <span class="fu">sqrt</span>(k) <span class="sc">-</span> eps))<span class="sc">$</span>root)</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>}</span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" tabindex="-1"></a>r11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb114-12"><a href="#cb114-12" tabindex="-1"></a>  <span class="fu">findIntersection</span>(k)</span>
<span id="cb114-13"><a href="#cb114-13" tabindex="-1"></a>})</span>
<span id="cb114-14"><a href="#cb114-14" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" tabindex="-1"></a>r11<span class="fl">.4</span></span></code></pre></div>
<pre><code>##  [1]  1.492073  1.533555  1.562745  1.584429  1.601184  1.614516  1.625389
##  [8]  1.634418  1.642026  1.648552  1.654175  1.659099  1.663454  1.667287
## [15]  1.670733  1.673832  1.676605  1.679148  1.681468  4.785832  4.888979
## [22]  4.990000  9.990000 22.350680 31.612777</code></pre>
<p>比较二者的结果，发现在k较小时二者都有非常相近的估计，但EX11.4相对更稳健。在k很大时，EX11.5得不到解，或者解的估计相对较差。</p>
</div>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<p>Suppose <span class="math inline">\(T_1,\ldots,T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda.\)</span> Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math display">\[Y_i=T_iI(T_i\leq\tau)+\tau
I(T_i&gt;\tau)\]</span> <span class="math inline">\(i=1,\ldots,n.\)</span> Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span>
Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co"># E步函数</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>E_step <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau, lambda0) {</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>  loglikelihood <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, <span class="fu">log</span>(lambda0) <span class="sc">-</span> lambda0 <span class="sc">*</span> Y, <span class="fu">log</span>(lambda0) <span class="sc">-</span> lambda0 <span class="sc">*</span> (tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda0))</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(loglikelihood))</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>}</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a><span class="co"># M步函数</span></span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>M_step <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau, lambda0) {</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>  expected_Ti <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, Y, tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda0)</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>  <span class="fu">return</span>(n <span class="sc">/</span> <span class="fu">sum</span>(expected_Ti))</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>}</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a><span class="co"># EM算法</span></span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a>EM_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau, lambda0) {</span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a>    Q_old <span class="ot">&lt;-</span> <span class="fu">E_step</span>(Y, tau, lambda0)</span>
<span id="cb116-19"><a href="#cb116-19" tabindex="-1"></a>    lambda1 <span class="ot">&lt;-</span> <span class="fu">M_step</span>(Y, tau, lambda0)</span>
<span id="cb116-20"><a href="#cb116-20" tabindex="-1"></a>    Q_new <span class="ot">&lt;-</span> <span class="fu">E_step</span>(Y, tau, lambda1)</span>
<span id="cb116-21"><a href="#cb116-21" tabindex="-1"></a>    <span class="co"># 同时考虑lambda的变化和对数似然期望的变化</span></span>
<span id="cb116-22"><a href="#cb116-22" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda1 <span class="sc">-</span> lambda0) <span class="sc">&lt;</span> <span class="fl">1e-6</span> <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(Q_new <span class="sc">-</span> Q_old) <span class="sc">&lt;</span> <span class="fl">1e-6</span>) {</span>
<span id="cb116-23"><a href="#cb116-23" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb116-24"><a href="#cb116-24" tabindex="-1"></a>    }</span>
<span id="cb116-25"><a href="#cb116-25" tabindex="-1"></a>    lambda0 <span class="ot">&lt;-</span> lambda1</span>
<span id="cb116-26"><a href="#cb116-26" tabindex="-1"></a>  }</span>
<span id="cb116-27"><a href="#cb116-27" tabindex="-1"></a>  <span class="fu">return</span>(lambda1)</span>
<span id="cb116-28"><a href="#cb116-28" tabindex="-1"></a>}</span>
<span id="cb116-29"><a href="#cb116-29" tabindex="-1"></a></span>
<span id="cb116-30"><a href="#cb116-30" tabindex="-1"></a><span class="co"># 观测数据的似然函数</span></span>
<span id="cb116-31"><a href="#cb116-31" tabindex="-1"></a>loglikelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau, lambda) {</span>
<span id="cb116-32"><a href="#cb116-32" tabindex="-1"></a>  loglik <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, <span class="fu">log</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> tau)) <span class="sc">*</span> lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> Y)), <span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> tau)))</span>
<span id="cb116-33"><a href="#cb116-33" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(loglik))</span>
<span id="cb116-34"><a href="#cb116-34" tabindex="-1"></a>}</span>
<span id="cb116-35"><a href="#cb116-35" tabindex="-1"></a></span>
<span id="cb116-36"><a href="#cb116-36" tabindex="-1"></a><span class="co"># 结果输出</span></span>
<span id="cb116-37"><a href="#cb116-37" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb116-38"><a href="#cb116-38" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb116-39"><a href="#cb116-39" tabindex="-1"></a>lambda0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb116-40"><a href="#cb116-40" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" tabindex="-1"></a><span class="fu">EM_algorithm</span>(Y, tau, lambda0) <span class="sc">%&gt;%</span></span>
<span id="cb116-42"><a href="#cb116-42" tabindex="-1"></a>  <span class="fu">round</span>(., <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-43"><a href="#cb116-43" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;EM算法估计的lambda值为：&#39;</span>, ., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## EM算法估计的lambda值为： 1.037</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>result_optim <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>  <span class="at">par =</span> lambda0, <span class="at">fn =</span> loglikelihood, <span class="at">method =</span> <span class="st">&#39;BFGS&#39;</span>, <span class="at">Y =</span> Y, <span class="at">tau =</span> tau)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  lambda_mle <span class="ot">&lt;-</span> <span class="fu">round</span>(result_optim<span class="sc">$</span>par, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;观测数据MLE估计的lambda值为：&#39;</span>,., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 观测数据MLE估计的lambda值为： 1.487</code></pre>
</div>
</div>
<div id="excecise-11.7-page-354-statistical-computing-with-r" class="section level1">
<h1>Excecise 11.7 (page 354, Statistical Computing with R)</h1>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x+2y+9z\)</span> subject to</p>
<p><span class="math display">\[\begin{aligned}&amp;2x+y+z\leq2\\&amp;x-y+3z\leq3\\&amp;x\geq0,\:y\geq0,\:z\geq0.\end{aligned}\]</span></p>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a>obj_coeffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>constraint_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>rhs_constants <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>constraint_directions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;&lt;&#39;</span>, <span class="st">&#39;&lt;&#39;</span>)</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="at">direction =</span> <span class="st">&#39;min&#39;</span>,</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>                <span class="at">objective.in =</span> obj_coeffs,</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>                <span class="at">const.mat =</span> constraint_matrix,</span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>                <span class="at">const.dir =</span> constraint_directions,</span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>                <span class="at">const.rhs =</span> rhs_constants)</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;目标函数的最优值为：&#39;</span>, solution<span class="sc">$</span>objval,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 目标函数的最优值为： 0</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;x的值为：&#39;</span>, solution<span class="sc">$</span>solution[<span class="dv">1</span>],<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## x的值为： 0</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;y的值为：&#39;</span>, solution<span class="sc">$</span>solution[<span class="dv">2</span>],<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## y的值为： 0</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;z的值为：&#39;</span>, solution<span class="sc">$</span>solution[<span class="dv">3</span>],<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## z的值为： 0</code></pre>
</div>
</div>
<div id="excecise-3-page-204-advanced-r" class="section level1">
<h1>Excecise 3 (page 204, Advanced R)</h1>
<p>Use both for loops and <code>lapply()</code> to fit linear models to
the <strong>mtcars</strong> using the formulas stored in this list:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>)</span></code></pre></div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co"># for loops</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>fl_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas)) {</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>  <span class="co"># 在每次循环中，使用当前公式拟合线性模型，并将结果存储到列表中</span></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>  fl_1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>}</span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>fl_1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>la_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>la_1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
</div>
<div id="excecise-4-page-204-advanced-r" class="section level1">
<h1>Excecise 4 (page 204, Advanced R)</h1>
<p>Fit the model <strong>mpg ~ disp</strong> to each of the bootstrap
replicates of <strong>mtcars</strong> in the list below by using a for
loop and <code>lapply()</code>. Can you do it without an anonymous
function?</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>})</span></code></pre></div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co"># for loops</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>fl_2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>  fl_2[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>}</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>fl_2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.97694     -0.04166  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.70745     -0.03731  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     32.3203      -0.0493  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.15189     -0.03845  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17436     -0.04023  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.82772     -0.03933  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.30792     -0.03819  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.73373     -0.03963  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30102     -0.04002  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.96080     -0.04234</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>la_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>la_2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.97694     -0.04166  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.70745     -0.03731  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     32.3203      -0.0493  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.15189     -0.03845  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17436     -0.04023  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.82772     -0.03933  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.30792     -0.03819  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.73373     -0.03963  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30102     -0.04002  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.96080     -0.04234</code></pre>
</div>
</div>
<div id="excecise-5-page-204-advanced-r" class="section level1">
<h1>Excecise 5 (page 204, Advanced R)</h1>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># Exercise 3</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">sapply</span>(fl_1, rsq) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;For loops model:</span><span class="sc">\n\t</span><span class="st">&#39;</span>, ., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## For loops model:
##   0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">sapply</span>(la_1, rsq) <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;lapply model:</span><span class="sc">\n\t</span><span class="st">&#39;</span>, ., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## lapply model:
##   0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="co"># Exercise 4</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="fu">sapply</span>(fl_2, rsq) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;For loops model:</span><span class="sc">\n\t</span><span class="st">&#39;</span>, ., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## For loops model:
##   0.7780357 0.6666969 0.7974516 0.7031851 0.7288652 0.7365056 0.7571542 0.6708369 0.7042389 0.7349527</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="fu">sapply</span>(la_2, rsq) <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;lapply model:</span><span class="sc">\n\t</span><span class="st">&#39;</span>, ., <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## lapply model:
##   0.7780357 0.6666969 0.7974516 0.7031851 0.7288652 0.7365056 0.7571542 0.6708369 0.7042389 0.7349527</code></pre>
</div>
</div>
<div id="excecise-3-page-213-214-advanced-r" class="section level1">
<h1>Excecise 3 (page 213-214, Advanced R)</h1>
<p>The following code simulates the performance of a t-test for
non-normal data. Use <code>sapply()</code> and an anonymous function to
extract the p-value from every trial.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co"># anonymous function:</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.34769718 0.66628075 0.05695509 0.98499774 0.19200671 0.28555260
##   [7] 0.04267940 0.73315300 0.59254759 0.24176527 0.42113208 0.76756884
##  [13] 0.12640274 0.48892497 0.83867887 0.54113500 0.65300535 0.94378913
##  [19] 0.88180955 0.63858938 0.93975704 0.93077977 0.50290220 0.58451942
##  [25] 0.08070803 0.95775634 0.91658233 0.11257987 0.38679656 0.57819031
##  [31] 0.55421438 0.94212014 0.66069012 0.70184352 0.40559646 0.66128476
##  [37] 0.96704383 0.77050902 0.71721906 0.67037252 0.86760435 0.25365940
##  [43] 0.50112304 0.52020952 0.26305663 1.00000000 0.66300221 0.80792331
##  [49] 0.09351574 0.32807703 0.11393069 0.21307611 0.23510906 0.77511269
##  [55] 0.99530118 0.61521165 0.08056051 0.79451092 0.83603414 0.33409257
##  [61] 0.33160469 0.76352468 0.89784932 0.22258444 0.67497337 0.83774468
##  [67] 0.44489116 0.11618735 0.93246504 0.31871212 0.83933519 0.13172904
##  [73] 0.46472770 0.88890023 0.47392581 0.50067315 0.55649281 0.47608698
##  [79] 0.05984525 0.32250918 0.89902725 0.83531980 0.14056541 0.43376149
##  [85] 0.50397149 0.26639234 0.47289279 0.64511152 0.72777969 0.20112836
##  [91] 0.86288815 0.70813645 0.77620681 0.36593096 0.18406873 0.86646588
##  [97] 0.71496790 0.73835569 0.80420710 0.39456615</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="co"># without anonymous function:</span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;p.value&#39;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.34769718 0.66628075 0.05695509 0.98499774 0.19200671 0.28555260
##   [7] 0.04267940 0.73315300 0.59254759 0.24176527 0.42113208 0.76756884
##  [13] 0.12640274 0.48892497 0.83867887 0.54113500 0.65300535 0.94378913
##  [19] 0.88180955 0.63858938 0.93975704 0.93077977 0.50290220 0.58451942
##  [25] 0.08070803 0.95775634 0.91658233 0.11257987 0.38679656 0.57819031
##  [31] 0.55421438 0.94212014 0.66069012 0.70184352 0.40559646 0.66128476
##  [37] 0.96704383 0.77050902 0.71721906 0.67037252 0.86760435 0.25365940
##  [43] 0.50112304 0.52020952 0.26305663 1.00000000 0.66300221 0.80792331
##  [49] 0.09351574 0.32807703 0.11393069 0.21307611 0.23510906 0.77511269
##  [55] 0.99530118 0.61521165 0.08056051 0.79451092 0.83603414 0.33409257
##  [61] 0.33160469 0.76352468 0.89784932 0.22258444 0.67497337 0.83774468
##  [67] 0.44489116 0.11618735 0.93246504 0.31871212 0.83933519 0.13172904
##  [73] 0.46472770 0.88890023 0.47392581 0.50067315 0.55649281 0.47608698
##  [79] 0.05984525 0.32250918 0.89902725 0.83531980 0.14056541 0.43376149
##  [85] 0.50397149 0.26639234 0.47289279 0.64511152 0.72777969 0.20112836
##  [91] 0.86288815 0.70813645 0.77620681 0.36593096 0.18406873 0.86646588
##  [97] 0.71496790 0.73835569 0.80420710 0.39456615</code></pre>
</div>
</div>
<div id="excecise-6-page-213-214-advanced-r" class="section level1">
<h1>Excecise 6 (page 213-214, Advanced R)</h1>
<p>Implement a combination of <code>Map()</code> and
<code>vapply()</code> to create an <code>lapply()</code> variant that
iterates in parallel over all of its inputs and stores its outputs in a
vector (or a matrix). What arguments should the function take?</p>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="co"># 自写lapply()</span></span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>my_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="at">simplify =</span> <span class="cn">FALSE</span>){</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>  <span class="cf">if</span> (simplify <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="fu">return</span>(<span class="fu">simplify2array</span>(out))</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="fu">Map</span>(<span class="cf">function</span>(x) <span class="fu">vapply</span>(x, FUN, FUN.VALUE), X))</span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>}</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a><span class="co"># 做一个简单测试</span></span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a>list_test <span class="ot">&lt;-</span> <span class="fu">list</span>(cars, mtcars)</span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a><span class="fu">my_lapply</span>(list_test, mean, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
## speed  dist 
## 15.40 42.98 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500</code></pre>
</div>
</div>
<div id="excecise-4-page-365-advanced-r" class="section level1">
<h1>Excecise 4 (page 365, Advanced R)</h1>
<p>Make a faster version of <code>chisq.test()</code> that only computes
the chi-square test statistic when the input is two numeric vectors with
no missing values. You can try simplifying <code>chisq.test()</code> or
by coding from the <a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">mathematical
definition</a>.</p>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="co"># 自写chisq.test()</span></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>my_chisq.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>  <span class="co"># 检查输入是否为两个数值向量且无缺失值</span></span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||!</span><span class="fu">is.numeric</span>(y) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&#39;应该输入两个无缺失值的数值向量。&#39;</span>)</span>
<span id="cb154-6"><a href="#cb154-6" tabindex="-1"></a>  }</span>
<span id="cb154-7"><a href="#cb154-7" tabindex="-1"></a></span>
<span id="cb154-8"><a href="#cb154-8" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb154-9"><a href="#cb154-9" tabindex="-1"></a>  margin1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(m)</span>
<span id="cb154-10"><a href="#cb154-10" tabindex="-1"></a>  margin2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m)</span>
<span id="cb154-11"><a href="#cb154-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(m)</span>
<span id="cb154-12"><a href="#cb154-12" tabindex="-1"></a>  me <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(margin1, margin2) <span class="sc">/</span> n</span>
<span id="cb154-13"><a href="#cb154-13" tabindex="-1"></a></span>
<span id="cb154-14"><a href="#cb154-14" tabindex="-1"></a>  <span class="co"># 计算卡方检验统计量</span></span>
<span id="cb154-15"><a href="#cb154-15" tabindex="-1"></a>  chi_square_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((m <span class="sc">-</span> me)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> me)</span>
<span id="cb154-16"><a href="#cb154-16" tabindex="-1"></a>  <span class="co"># 计算自由度</span></span>
<span id="cb154-17"><a href="#cb154-17" tabindex="-1"></a>  degrees_of_freedom <span class="ot">&lt;-</span> (<span class="fu">length</span>(margin1) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(margin2) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb154-18"><a href="#cb154-18" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb154-19"><a href="#cb154-19" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chi_square_stat, <span class="at">df =</span> degrees_of_freedom, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb154-20"><a href="#cb154-20" tabindex="-1"></a></span>
<span id="cb154-21"><a href="#cb154-21" tabindex="-1"></a>  <span class="co"># 返回卡方检验统计量、自由度和p值组成的列表</span></span>
<span id="cb154-22"><a href="#cb154-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chi_square_statistic =</span> chi_square_stat,</span>
<span id="cb154-23"><a href="#cb154-23" tabindex="-1"></a>              <span class="at">degrees_of_freedom =</span> degrees_of_freedom,</span>
<span id="cb154-24"><a href="#cb154-24" tabindex="-1"></a>              <span class="at">p_value =</span> p_value))</span>
<span id="cb154-25"><a href="#cb154-25" tabindex="-1"></a>}</span></code></pre></div>
<p>测试比较</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-5"><a href="#cb155-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb155-6"><a href="#cb155-6" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" tabindex="-1"></a><span class="co"># chisq.test()结果</span></span>
<span id="cb155-8"><a href="#cb155-8" tabindex="-1"></a><span class="fu">chisq.test</span>(m)</span></code></pre></div>
<pre><code>## Warning in chisq.test(m): Chi-squared近似算法有可能不准</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  m
## X-squared = 166.05, df = 99, p-value = 2.832e-05</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="co"># 自写chisq.test()结果</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a><span class="fu">my_chisq.test</span>(x, y)</span></code></pre></div>
<pre><code>## $chi_square_statistic
## [1] 166.0489
## 
## $degrees_of_freedom
## [1] 99
## 
## $p_value
## [1] 2.832493e-05</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="co"># 性能评估和比较</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>  bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>    <span class="fu">chisq.test</span>(m), </span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a>    <span class="fu">my_chisq.test</span>(x, y), </span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">FALSE</span></span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a>  )</span>
<span id="cb160-8"><a href="#cb160-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   expression               min   median `itr/sec` mem_alloc `gc/sec`
##   &lt;bch:expr&gt;          &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;
## 1 chisq.test(m)        158.6µs  232.3µs     3795.   29.45KB     4.15
## 2 my_chisq.test(x, y)   17.6µs   31.1µs    24516.    7.36KB     4.90</code></pre>
<p>结果显示<code>my_chisq.test()</code>函数比<code>chisq.test()</code>更快。</p>
</div>
</div>
<div id="excecise-5-page-365-advanced-r" class="section level1">
<h1>Excecise 5 (page 365, Advanced R)</h1>
<p>Can you make a faster version of <code>table()</code> for the case of
an input of two integer vectors with no missing values? Can you use it
to speed up your chi-square test?</p>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="co"># 自写table()</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a>my_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a>  <span class="co"># 检查输入是否为两个整数型向量且无缺失值</span></span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||!</span><span class="fu">is.integer</span>(y) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&#39;应该输入两个无缺失值的整数型向量。&#39;</span>)</span>
<span id="cb162-6"><a href="#cb162-6" tabindex="-1"></a>  }</span>
<span id="cb162-7"><a href="#cb162-7" tabindex="-1"></a>  </span>
<span id="cb162-8"><a href="#cb162-8" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb162-9"><a href="#cb162-9" tabindex="-1"></a>  unique_x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb162-10"><a href="#cb162-10" tabindex="-1"></a>  unique_y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb162-11"><a href="#cb162-11" tabindex="-1"></a>  </span>
<span id="cb162-12"><a href="#cb162-12" tabindex="-1"></a>  num_unique_x <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_x)</span>
<span id="cb162-13"><a href="#cb162-13" tabindex="-1"></a>  num_unique_y <span class="ot">&lt;-</span> <span class="fu">length</span>(unique_y)</span>
<span id="cb162-14"><a href="#cb162-14" tabindex="-1"></a>  </span>
<span id="cb162-15"><a href="#cb162-15" tabindex="-1"></a>  table_dimensions  <span class="ot">&lt;-</span> <span class="fu">c</span>(num_unique_x, num_unique_y)</span>
<span id="cb162-16"><a href="#cb162-16" tabindex="-1"></a>  combinations_total <span class="ot">&lt;-</span> num_unique_x <span class="sc">*</span> num_unique_y</span>
<span id="cb162-17"><a href="#cb162-17" tabindex="-1"></a>  dimension_names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> unique_x, <span class="at">y =</span> unique_y)</span>
<span id="cb162-18"><a href="#cb162-18" tabindex="-1"></a>  </span>
<span id="cb162-19"><a href="#cb162-19" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(x, unique_x) <span class="sc">+</span></span>
<span id="cb162-20"><a href="#cb162-20" tabindex="-1"></a>    num_unique_x <span class="sc">*</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(y, unique_y) <span class="sc">-</span> num_unique_x</span>
<span id="cb162-21"><a href="#cb162-21" tabindex="-1"></a>  count_vector <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(bin, combinations_total)</span>
<span id="cb162-22"><a href="#cb162-22" tabindex="-1"></a>  </span>
<span id="cb162-23"><a href="#cb162-23" tabindex="-1"></a>  count_array  <span class="ot">&lt;-</span> <span class="fu">array</span>(count_vector, <span class="at">dim =</span> table_dimensions, <span class="at">dimnames =</span> dimension_names)</span>
<span id="cb162-24"><a href="#cb162-24" tabindex="-1"></a>  <span class="fu">class</span>(count_array) <span class="ot">&lt;-</span> <span class="st">&#39;table&#39;</span></span>
<span id="cb162-25"><a href="#cb162-25" tabindex="-1"></a>  </span>
<span id="cb162-26"><a href="#cb162-26" tabindex="-1"></a>  <span class="fu">return</span>(count_array)</span>
<span id="cb162-27"><a href="#cb162-27" tabindex="-1"></a>}</span></code></pre></div>
<p>测试比较</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb163-2"><a href="#cb163-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-3"><a href="#cb163-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-4"><a href="#cb163-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-5"><a href="#cb163-5" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" tabindex="-1"></a><span class="co"># 比较二者是否一致</span></span>
<span id="cb163-7"><a href="#cb163-7" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">table</span>(x, y), <span class="fu">my_table</span>(x, y))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a><span class="co"># 性能评估和比较</span></span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(<span class="fu">table</span>(x, y), <span class="fu">my_table</span>(x, y), <span class="at">check =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   expression          min   median `itr/sec` mem_alloc `gc/sec`
##   &lt;bch:expr&gt;     &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;
## 1 table(x, y)       192µs    288µs     2820.   103.8KB     6.44
## 2 my_table(x, y)    114µs    176µs     4986.    48.5KB     4.20</code></pre>
<p>结果显示<code>my_table()</code>函数比<code>chisq.table()</code>更快。</p>
<p>由于上一题中我并没有使用<code>table()</code>函数来建立自己的<code>chisq.test()</code>，因此不能通过新建立的<code>my_table()</code>函数来加速<code>my_chisq.test()</code>.</p>
</div>
</div>
<div id="excecise-9.8" class="section level1">
<h1>Excecise 9.8</h1>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\propto\binom
nxy^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,\ldots,n,\:0\leq y\leq1.\]</span>
It can be shown that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
Binomial<span class="math inline">\((n,y)\)</span> and Beta<span class="math inline">\((x+a,n-x+b).\)</span> Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y).\)</span></p>
<div id="write-an-rcpp-function-for-exercise-9.8" class="section level2">
<h2>Write an Rcpp function for Exercise 9.8</h2>
<p>这是cpp的代码</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> 计算二项式系数</span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>int <span class="fu">binomialCoefficient</span>(int n, int k) {</span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>    <span class="cf">if</span> (k <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> k <span class="sc">==</span> n) return <span class="dv">1</span>;</span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a>    return <span class="fu">binomialCoefficient</span>(n <span class="sc">-</span> <span class="dv">1</span>, k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">binomialCoefficient</span>(n <span class="sc">-</span> <span class="dv">1</span>, k);</span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a>}</span>
<span id="cb167-9"><a href="#cb167-9" tabindex="-1"></a></span>
<span id="cb167-10"><a href="#cb167-10" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> Gibbs</span>
<span id="cb167-11"><a href="#cb167-11" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb167-12"><a href="#cb167-12" tabindex="-1"></a>List <span class="fu">gibbsSampler</span>(int n, int a, int b, int m) {</span>
<span id="cb167-13"><a href="#cb167-13" tabindex="-1"></a>    <span class="sc">/</span><span class="er">/</span> 存储生成的样本</span>
<span id="cb167-14"><a href="#cb167-14" tabindex="-1"></a>    NumericMatrix <span class="fu">xSamples</span>(m, <span class="dv">1</span>);</span>
<span id="cb167-15"><a href="#cb167-15" tabindex="-1"></a>    NumericMatrix <span class="fu">ySamples</span>(m, <span class="dv">1</span>);</span>
<span id="cb167-16"><a href="#cb167-16" tabindex="-1"></a>    <span class="sc">/</span><span class="er">/</span> 初始化 x 和 y</span>
<span id="cb167-17"><a href="#cb167-17" tabindex="-1"></a>    int x <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb167-18"><a href="#cb167-18" tabindex="-1"></a>    double y <span class="ot">=</span> <span class="fl">0.5</span>;</span>
<span id="cb167-19"><a href="#cb167-19" tabindex="-1"></a>    <span class="cf">for</span> (int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> m; <span class="sc">++</span>i) {</span>
<span id="cb167-20"><a href="#cb167-20" tabindex="-1"></a>        x <span class="ot">=</span> R<span class="sc">::</span><span class="fu">rbinom</span>(n, y);</span>
<span id="cb167-21"><a href="#cb167-21" tabindex="-1"></a>        y <span class="ot">=</span> R<span class="sc">::</span><span class="fu">rbeta</span>(x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b);</span>
<span id="cb167-22"><a href="#cb167-22" tabindex="-1"></a>        <span class="fu">xSamples</span>(i, <span class="dv">0</span>) <span class="ot">=</span> x;</span>
<span id="cb167-23"><a href="#cb167-23" tabindex="-1"></a>        <span class="fu">ySamples</span>(i, <span class="dv">0</span>) <span class="ot">=</span> y;</span>
<span id="cb167-24"><a href="#cb167-24" tabindex="-1"></a>    }</span>
<span id="cb167-25"><a href="#cb167-25" tabindex="-1"></a>    return List<span class="sc">::</span><span class="fu">create</span>(<span class="fu">Named</span>(<span class="st">&quot;xSamples&quot;</span>) <span class="ot">=</span> xSamples,</span>
<span id="cb167-26"><a href="#cb167-26" tabindex="-1"></a>                        <span class="fu">Named</span>(<span class="st">&quot;ySamples&quot;</span>) <span class="ot">=</span> ySamples);</span>
<span id="cb167-27"><a href="#cb167-27" tabindex="-1"></a>}</span></code></pre></div>
<p>调用cpp</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;Gibbs.cpp&#39;</span>) </span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a><span class="do">## 设置参数</span></span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb168-5"><a href="#cb168-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb168-6"><a href="#cb168-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb168-7"><a href="#cb168-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb168-8"><a href="#cb168-8" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" tabindex="-1"></a><span class="do">## Cpp结果</span></span>
<span id="cb168-10"><a href="#cb168-10" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">gibbsSampler</span>(n, a, b, m)</span>
<span id="cb168-11"><a href="#cb168-11" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> results<span class="sc">$</span>xSamples</span>
<span id="cb168-12"><a href="#cb168-12" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> results<span class="sc">$</span>ySamples</span>
<span id="cb168-13"><a href="#cb168-13" tabindex="-1"></a><span class="fu">head</span>(x_samples)</span>
<span id="cb168-14"><a href="#cb168-14" tabindex="-1"></a><span class="fu">head</span>(y_samples)</span></code></pre></div>
</div>
<div id="compare-the-corresponding-generated-random-numbers-with-those-by-the-r-function-you-wrote-using-the-function-qqplot." class="section level2">
<h2>Compare the corresponding generated random numbers with those by the
R function you wrote using the function ‘qqplot’.</h2>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" tabindex="-1"></a><span class="do">## 使用R自带函数生成随机数</span></span>
<span id="cb169-5"><a href="#cb169-5" tabindex="-1"></a>Gibbs_R <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, m) {</span>
<span id="cb169-6"><a href="#cb169-6" tabindex="-1"></a>  x_samples_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb169-7"><a href="#cb169-7" tabindex="-1"></a>  y_samples_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb169-8"><a href="#cb169-8" tabindex="-1"></a></span>
<span id="cb169-9"><a href="#cb169-9" tabindex="-1"></a>  <span class="co"># 初始化y</span></span>
<span id="cb169-10"><a href="#cb169-10" tabindex="-1"></a>  y_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb169-11"><a href="#cb169-11" tabindex="-1"></a></span>
<span id="cb169-12"><a href="#cb169-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb169-13"><a href="#cb169-13" tabindex="-1"></a>    x_samples_r[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_temp)</span>
<span id="cb169-14"><a href="#cb169-14" tabindex="-1"></a>    y_temp <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_samples_r[i] <span class="sc">+</span> a, n <span class="sc">-</span> x_samples_r[i] <span class="sc">+</span> b)</span>
<span id="cb169-15"><a href="#cb169-15" tabindex="-1"></a>    y_samples_r[i] <span class="ot">&lt;-</span> y_temp</span>
<span id="cb169-16"><a href="#cb169-16" tabindex="-1"></a>  }</span>
<span id="cb169-17"><a href="#cb169-17" tabindex="-1"></a></span>
<span id="cb169-18"><a href="#cb169-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x_samples =</span> x_samples_r, <span class="at">y_samples =</span> y_samples_r))</span>
<span id="cb169-19"><a href="#cb169-19" tabindex="-1"></a>}</span>
<span id="cb169-20"><a href="#cb169-20" tabindex="-1"></a></span>
<span id="cb169-21"><a href="#cb169-21" tabindex="-1"></a><span class="do">## 调用Gibbs_R生成随机数</span></span>
<span id="cb169-22"><a href="#cb169-22" tabindex="-1"></a>result_R <span class="ot">&lt;-</span> <span class="fu">Gibbs_R</span>(n, a, b, m)</span>
<span id="cb169-23"><a href="#cb169-23" tabindex="-1"></a>x_r_samples <span class="ot">&lt;-</span> result_R<span class="sc">$</span>x_samples</span>
<span id="cb169-24"><a href="#cb169-24" tabindex="-1"></a>y_r_samples <span class="ot">&lt;-</span> result_R<span class="sc">$</span>y_samples</span>
<span id="cb169-25"><a href="#cb169-25" tabindex="-1"></a></span>
<span id="cb169-26"><a href="#cb169-26" tabindex="-1"></a><span class="do">## 画图</span></span>
<span id="cb169-27"><a href="#cb169-27" tabindex="-1"></a><span class="fu">qqplot</span>(x_r_samples, x_samples,</span>
<span id="cb169-28"><a href="#cb169-28" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;Random x generated by R built-in function&#39;</span>,</span>
<span id="cb169-29"><a href="#cb169-29" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&#39;Random x generated by Rcpp function&#39;</span>,</span>
<span id="cb169-30"><a href="#cb169-30" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&#39;QQ plot of x random numbers&#39;</span>)</span>
<span id="cb169-31"><a href="#cb169-31" tabindex="-1"></a></span>
<span id="cb169-32"><a href="#cb169-32" tabindex="-1"></a><span class="fu">qqplot</span>(y_r_samples, y_samples,</span>
<span id="cb169-33"><a href="#cb169-33" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;Random y generated by R built-in function&#39;</span>,</span>
<span id="cb169-34"><a href="#cb169-34" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&#39;Random y generated by Rcpp function&#39;</span>,</span>
<span id="cb169-35"><a href="#cb169-35" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&#39;QQ plot of y random numbers&#39;</span>)</span></code></pre></div>
</div>
<div id="campare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level2">
<h2>Campare the computation time of the two functions with the function
‘microbenchmark’.</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="do">## 比较</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="fu">microbenchmark</span>(</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>    <span class="at">Rcpp_function =</span> <span class="fu">gibbsSampler</span>(n, a, b, m),</span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>    <span class="at">R_function =</span> <span class="fu">Gibbs_R</span>(n, a, b, m)</span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb170-6"><a href="#cb170-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
</div>
<div id="comments-your-results" class="section level2">
<h2>Comments your results</h2>
<p>Cpp在计算时间方面表现出明显的优势，其执行速度远快于R.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
